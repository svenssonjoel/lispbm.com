<!DOCTYPE html>

<html lang="en-US">

<head>
  <meta charset="UTF-8">
  <meta name="description" content="LispBM Reference Documentation - ">
  <meta name="keywords" content="lispbm, lisp, reference, documentation, embedded lisp, microcontroller, ">
  <meta name="author" content="Bo Joel Svensson">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO Meta Tags -->

  <link rel="canonical" href="https://www.lispbm.com/lispbm-reference-manual/vesc-express-display/" />
  <meta name="robots" content="index, follow">

  <!-- Open Graph Meta Tags -->

  <meta property="og:title" content="">
  <meta property="og:description" content="LispBM Reference Documentation - ">
  <meta property="og:image" content="https://www.lispbm.com/images/lispbm_llama_small.png">
  <meta property="og:url" content="https://www.lispbm.com/lispbm-reference-manual/vesc-express-display/">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="LispBM">

  <!-- Twitter Card Meta Tags -->

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="">
  <meta name="twitter:description" content="LispBM Reference Documentation - ">
  <meta name="twitter:image" content="https://www.lispbm.com/images/lispbm_llama_small.png">

  <link rel="apple-touch-icon" sizes="180x180" href="https://www.lispbm.com/ico/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://www.lispbm.com/ico/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://www.lispbm.com/ico/favicon-16x16.png">
  <link rel="shortcut icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" type="image/x-icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="manifest" href="https://www.lispbm.com/ico/site.webmanifest">

  <link rel="stylesheet" href="reference.css">

  <title></title>
</head>

<body>

<div style="max-width: 900px; margin: 0 auto; padding: 20px;">
  <div style="margin-bottom: 20px;">
    <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê Back to Reference Manual Index</a>
  </div>

<!-- Content starts here -->

<h1
id="documentation-for-graphics-library-and-display-drivers">Documentation
for graphics library and display drivers</h1>
<h1 id="introduction">Introduction</h1>
<p>The graphics library provides a set of functions for drawing onto
rectangular images, called Image-buffers, from LispBM.</p>
<p>Drivers for a specific display is loaded with the associated
<code>disp-load</code> function:</p>
<ol type="1">
<li>disp-load-sh8501b</li>
<li>disp-load-ili9341</li>
<li>disp-load-ssd1306</li>
</ol>
<p>Each disp-load function takes arguments specific to the display.
These are explained below.</p>
<p>Each display driver provides a "rendering", "clearing" and "reset"
function that is connected to the LispBM extensions
<code>disp-render</code>, <code>disp-clear</code> and
<code>disp-reset</code> upon loading. The render, clear and reset
functions are the display dependent interface that must be implemented
per display.</p>
<h2 id="image-buffers">Image-buffers</h2>
<p>The graphics library is based on image-buffers, that are rectangular
arrays of pixels where all pixels are of a certain format. The formats
we support in image-buffers are:</p>
<ol type="1">
<li>indexed2 - 2 colors (1 bit per pixel)</li>
<li>indexed4 - 4 colors (2 bits per pixel)</li>
<li>indexed16 - 16 colors (4 bits per pixel)</li>
<li>rgb332 - 8Bit color</li>
<li>rgb565 - 16Bit color</li>
<li>rgb888 - 24Bit color</li>
</ol>
<p>Image-buffers can be created in two ways using the graphics
library:</p>
<ol type="1">
<li><code>img-buffer</code> - allocates a blank image-buffer in lbm
memory.</li>
<li><code>img-buffer-from-bin</code> - creates an image-buffer from an
image imported into the script.</li>
</ol>
<p>For example, creating a 100x100 image-buffer of <code>indexed2</code>
colors is done as:</p>
<div class="sourceCode" id="cb1"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> my-img </span>(img-buffer <span class="at">&#39;indexed2</span> <span class="dv">100</span> <span class="dv">100</span>))</span></code></pre></div>
<p>When drawing on <code>indexed2</code> or <code>indexed4</code>
image-buffers, colors are expressed as an integer. 0,1 for
<code>indexed2</code>, 0,1,2,3 for <code>indexed4</code> and 0 to 15 for
<code>indexed16</code>. For <code>rgb332</code>, <code>rgb565</code> and
<code>rgb888</code> image-buffers a color is given in hex notation
0xRRGGBB.</p>
<p>Example that draws a line from pos (0,0) to pos (90,90) in color 1 on
an <code>indexed2</code> image-buffer:</p>
<div class="sourceCode" id="cb2"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>(img-line my-img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">90</span> <span class="dv">90</span> <span class="dv">1</span>)</span></code></pre></div>
<p>When an image-buffer is rendered onto the display (using the
disp-render function) the colors of the image-buffer are mapped to the
color space of the display. In the case of <code>indexed2</code>,
<code>indexed4</code> and <code>indexed16</code> this mapping is
performed using a list of target colors expressed in RGB888 format.</p>
<p>Note that the RAM requirement of a 100x100 image is:</p>
<ol type="1">
<li>at indexed2: 1250 Bytes</li>
<li>at indexed4: 2500 Bytes</li>
<li>at indexed16: 5000 Bytes</li>
<li>at rgb332: 10000 Bytes</li>
<li>at rgb565: 20000 Bytes</li>
<li>at rgb888: 30000 Bytes</li>
</ol>
<p>There are a number of function for drawing onto an image-buffer:</p>
<ol type="1">
<li>img-setpix</li>
<li>img-line</li>
<li>img-text</li>
<li>img-clear</li>
<li>img-circle</li>
<li>img-arc</li>
<li>img-circle-sector</li>
<li>img-circle-segment</li>
<li>img-rectangle</li>
<li>img-triangle</li>
<li>img-blit</li>
</ol>
<p>The purpose of most of these are given by their names.
<code>img-blit</code> draws an image onto another image and can while
doing so rotate and scale the image it is drawing. More details on each
of these functions are available in the later reference sections.</p>
<p>The functions that draw onto an image-buffer takes optional arguments
that specify extra attributes to apply when drawing. These attributes
are:</p>
<ol type="1">
<li><code>'(thickness w)</code>: Line thickness <code>w</code>. For most
shapes, the thickness extends inwards. But for <code>img-triangle</code>
and <code>img-line</code>, it extends equal outwards and inwards, so the
total line thickness is actually equal to two times <code>w</code>.</li>
<li><code>'(dotted d-len d-space-len)</code>: Dotted or dashed lines
with <code>d-len</code> long line segments separated by
<code>d-space-len</code>.</li>
<li><code>'(filled)</code>: Specifies that the shape should be
filled.</li>
<li><code>'(rounded radius)</code>: Specifies that the shape should have
rounded corners. Additionally, the <code>img-arc</code> function can
take this argument in the form <code>'(rounded)</code> to specify that,
when the arc isn't filled or dotted, the line ends should be rounded.
Sadly, this is the only function that can draw lines with square ends
right now.</li>
<li><code>'(scale scale-f)</code>: Scale the image by factor
<code>scale-f</code></li>
<li><code>'(rotate rx ry deg)</code>: Rotate an image around point
(<code>rx</code>,<code>ry</code>), <code>deg</code> degrees.</li>
<li><code>'(resolution steps)</code>: How many lines dotted arcs are
simplified into when drawn. Non-dotted arcs use a newer algorithm that's
pixel perfect. When drawing dotted arcs, they are simplified into a
series of lines where the actual amount of steps is scaled from
<code>0</code> to <code>steps</code> based on the arc angle span. Note
that this isn't just limited to <code>img-arc</code>, but every function
that draws any kind of arc, like actual arcs, circle segments and
sectors, rounded shapes, or dotted circles. The default is
<code>80</code>.</li>
</ol>
<p>Not all attributes are applicable to all drawing functions. The
applicable attributes for each drawing-function is listed in the
description of the function in the reference section.</p>
<h2 id="rendering-and-color-mapping">Rendering and color mapping</h2>
<p>An image-buffer can be rendered to the display using
<code>disp-render</code>. If the image is an <code>indexed2</code>,
<code>indexed4</code> or <code>indexed16</code> color image, it is when
rendering the image you decide what color each index in the image
represents.</p>
<p>For example you can draw an indexed2 image using a very red and a
green color as:</p>
<div class="sourceCode" id="cb3"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(disp-render my-img <span class="dv">10</span> <span class="dv">10</span> &#39;(<span class="bn">0x00FF00</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p>The code above draws <code>my-img</code> at location (10,10). Zeroes
in the image will be drawn using color <code>0x00FF00</code>, maximum
green, and ones will be drawn as <code>0xFF0000</code> maximum red.</p>
<p>For rgb332, rgb565 and rgb888 formats the color mapping list is
ignored and can be empty.</p>
<p>More advanced color mapping schemes can be represented using a color
type that is created using the <code>img-color</code> or
<code>img-color-setpre</code> functions. The color type can represent
normal colors, such as 0xFF0000, but can also represent gradients to be
applied to the image in x or y direction upon rendering.</p>
<h1 id="displays">Displays</h1>
<h2 id="sh8501b">sh8501b</h2>
<ul>
<li>Resolution: 194 * 368</li>
<li>Colors: 16Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-sh8501b">disp-load-sh8501b</h3>
<div class="sourceCode" id="cb4"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>(disp-load-sh8501b gpio-sd0 gpio-clk gpio-cs gpio-reset spi-mhz)</span></code></pre></div>
<p>Loads the sh8501b driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins.</p>
<p>Example using GPIO pins 6,5,7 and 8 for sd0,clk,cs and reset running
the SPI clock at 40MHz:</p>
<div class="sourceCode" id="cb5"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(disp-load-sh8501b <span class="dv">6</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">40</span>)</span></code></pre></div>
<h2 id="ili9341">ili9341</h2>
<ul>
<li>Resolution: 320 * 240</li>
<li>Colors: 16Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-ili9341">disp-load-ili9341</h3>
<div class="sourceCode" id="cb6"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ili9341 gpio-sd0 gpio-clk gpio-cs gpio-reset gpio-dc spi-mhz)</span></code></pre></div>
<p>Loads the ili9341 driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins. In addition, the ili9341 uses a
data/command signal to discern between commands and data. The
data/command signal is mapped to GPIO <code>gpio-cs</code>.</p>
<p>Example using GPIO pins 6,5,19,18 and 7 for sd0,clk,cs,reset and dc.
The SPI clock is set to 40MHz.</p>
<div class="sourceCode" id="cb7"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ili9341 <span class="dv">6</span> <span class="dv">5</span> <span class="dv">19</span> <span class="dv">18</span> <span class="dv">7</span> <span class="dv">40</span>)</span></code></pre></div>
<h2 id="ssd1306">ssd1306</h2>
<ul>
<li>Resolution: 128 * 64</li>
<li>Colors: B/W (1bpp)</li>
<li>Interface: I2C</li>
</ul>
<p>Can display images of <code>indexed2</code> format and is limited to
displaying only full screen images starting at position (0, 0).</p>
<h3 id="disp-load-ssd1306">disp-load-ssd1306</h3>
<div class="sourceCode" id="cb8"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ssd1306 gpio-sda gpio-scl i2c-hz)</span></code></pre></div>
<p>Load the ssd1306 driver. The ssd1306 talks I2C over the GPIOs
<code>gpio-sda</code> (serial data) and <code>gpio-scl</code>
(clock).</p>
<p>Example using GPIO pins 7 and 6 for serial data and clock.</p>
<div class="sourceCode" id="cb9"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ssd1306 <span class="dv">7</span> <span class="dv">6</span> <span class="dv">700000</span>)</span></code></pre></div>
<h2 id="st7789">st7789</h2>
<ul>
<li>Resolution: up to 320 * 240</li>
<li>Colors: 16Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-st7789">disp-load-st7789</h3>
<div class="sourceCode" id="cb10"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>(disp-load-st7789 gpio-sd0 gpio-clk gpio-cs gpio-reset gpio-dc spi-mhz)</span></code></pre></div>
<p>Loads the st7789 driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins. In addition, the st7789 uses a
data/command signal to discern between commands and data. The
data/command signal is mapped to GPIO <code>gpio-cs</code>.</p>
<p>Example using GPIO pins 6,5,19,18 and 7 for sd0,clk,cs,reset and dc.
The SPI clock is set to 40MHz.</p>
<div class="sourceCode" id="cb11"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(disp-load-st7789 <span class="dv">6</span> <span class="dv">5</span> <span class="dv">19</span> <span class="dv">18</span> <span class="dv">7</span> <span class="dv">40</span>)</span></code></pre></div>
<p><strong>Note</strong> Many st7789-based displays do not have the full
resolution that the driver supports in the panel. Some of them also have
an offset where the panel starts. The panel size and offset has to be
taken into account when using disp-render.</p>
<h2 id="st7735">st7735</h2>
<ul>
<li>Resolution: up to 162 * 132</li>
<li>Colors: 16Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-st7735">disp-load-st7735</h3>
<div class="sourceCode" id="cb12"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(disp-load-st7735 gpio-sd0 gpio-clk gpio-cs gpio-reset gpio-dc spi-mhz)</span></code></pre></div>
<p>Loads the st7735 driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins. In addition, the st7789 uses a
data/command signal to discern between commands and data. The
data/command signal is mapped to GPIO <code>gpio-cs</code>.</p>
<p>Example using GPIO pins 6,5,19,18 and 7 for sd0,clk,cs,reset and dc.
The SPI clock is set to 40MHz.</p>
<div class="sourceCode" id="cb13"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(disp-load-st7789 <span class="dv">6</span> <span class="dv">5</span> <span class="dv">19</span> <span class="dv">18</span> <span class="dv">7</span> <span class="dv">40</span>)</span></code></pre></div>
<p><strong>Note</strong> Many st7735-based displays do not have the full
resolution that the driver supports in the panel. Some of them also have
an offset where the panel starts. The panel size and offset has to be
taken into account when using disp-render.</p>
<h2 id="ili9488">ili9488</h2>
<ul>
<li>Resolution: 480 ** 320</li>
<li>Colors: 24Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-ili9488">disp-load-ili9488</h3>
<div class="sourceCode" id="cb14"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ili9488 gpio-sd0 gpio-clk gpio-cs gpio-reset gpio-dc spi-mhz)</span></code></pre></div>
<p>Loads the ili9488 driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins. In addition, the ili9488 uses a
data/command signal to discern between commands and data. The
data/command signal is mapped to GPIO <code>gpio-cs</code>.</p>
<p>Example using GPIO pins 6,5,19,18 and 7 for sd0,clk,cs,reset and dc.
The SPI clock is set to 40MHz.</p>
<div class="sourceCode" id="cb15"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ili9488 <span class="dv">6</span> <span class="dv">5</span> <span class="dv">19</span> <span class="dv">18</span> <span class="dv">7</span> <span class="dv">40</span>)</span></code></pre></div>
<h2 id="ssd1351">ssd1351</h2>
<ul>
<li>Resolution: 128 * 128</li>
<li>Colors: 16Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-ssd1351">disp-load-ssd1351</h3>
<div class="sourceCode" id="cb16"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ssd1351 gpio-sd0 gpio-clk gpio-cs gpio-reset gpio-dc spi-mhz)</span></code></pre></div>
<p>Loads the ssd1351 driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins. In addition, the ssd1351 uses a
data/command signal to discern between commands and data. The
data/command signal is mapped to GPIO <code>gpio-cs</code>.</p>
<p>Example using GPIO pins 6,5,19,18 and 7 for sd0,clk,cs,reset and dc.
The SPI clock is set to 40MHz.</p>
<div class="sourceCode" id="cb17"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(disp-load-ssd1351 <span class="dv">6</span> <span class="dv">5</span> <span class="dv">19</span> <span class="dv">18</span> <span class="dv">7</span> <span class="dv">40</span>)</span></code></pre></div>
<h2 id="icna3306">icna3306</h2>
<ul>
<li>Resolution: 194 * 368</li>
<li>Colors: 16Bit</li>
<li>Interface: SPI</li>
</ul>
<p>Compatible with all image formats supported by the graphics
library.</p>
<h3 id="disp-load-icna3306">disp-load-icna3306</h3>
<div class="sourceCode" id="cb18"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>(disp-load-icna3306 gpio-sd0 gpio-clk gpio-cs gpio-reset spi-mhz)</span></code></pre></div>
<p>Loads the icna3306 driver. The driver uses hardware-SPI at rate
<code>spi-mhz</code> on the <code>gpio-sd0</code> and
<code>gpio-clk</code> GPIO pins.</p>
<p>Example using GPIO pins 6,5,7 and 8 for sd0,clk,cs and reset running
the SPI clock at 40MHz:</p>
<div class="sourceCode" id="cb19"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(disp-load-icna3306 <span class="dv">6</span> <span class="dv">5</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">40</span>)</span></code></pre></div>
<h1 id="common-display-operations">Common display operations</h1>
<h2 id="disp-reset">disp-reset</h2>
<div class="sourceCode" id="cb20"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>(disp-reset)</span></code></pre></div>
<p>Resets and clears the display.</p>
<h2 id="disp-clear">disp-clear</h2>
<div class="sourceCode" id="cb21"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(disp-clear)</span></code></pre></div>
<p>Clears the display by writing zero to all pixel locations.</p>
<div class="sourceCode" id="cb22"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>(disp-clear color)</span></code></pre></div>
<p>Clears the display to the given color. The color is expressed in hex
rgb888 format 0xRRGGBB.</p>
<h2 id="disp-render">disp-render</h2>
<div class="sourceCode" id="cb23"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(disp-render img px py colors)</span></code></pre></div>
<p>Renders an image <code>img</code> at position (<code>px</code>,
<code>py</code>). If the picture is of <code>'indexed2</code>,
<code>'indexed4</code> or <code>indexed16</code> format the
<code>colors</code> argument is used to map the values of the image to
colors on the display.</p>
<p><code>colors</code> can be a list of numbers expressed int hex rgb888
format. For example:</p>
<div class="sourceCode" id="cb24"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>&#39;(<span class="bn">0x000000</span> <span class="bn">0xFFFFFF</span>)</span></code></pre></div>
<p>Or for a 4 color image (`'indexed4):</p>
<div class="sourceCode" id="cb25"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>&#39;(<span class="bn">0x000000</span> <span class="bn">0xFF0000</span> <span class="bn">0x00FF00</span> <span class="bn">0x0000FF</span>)</span></code></pre></div>
<p>The <code>colors</code> argument can also be made up of colors
created using the <code>img-color</code> function.</p>
<p>As an example, the two programs below render an image using colors
black and red:</p>
<p><em>using a list of numbers representing colors</em></p>
<div class="sourceCode" id="cb26"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> &#39;(<span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><em>using a list of colors</em></p>
<div class="sourceCode" id="cb27"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> (img-color <span class="at">&#39;regular</span> <span class="bn">0x000000</span>)</span>
<span id="cb27-2"><a href="#cb27-2" aria-hidden="true" tabindex="-1"></a>                           (img-color <span class="at">&#39;regular</span> <span class="bn">0xFF0000</span>)))</span></code></pre></div>
<p>A gradient can be applied to the picture when rendering. This is done
using the arguments <code>'gradient_x</code>, <code>'gradient_y</code>
to img-color. look up <code>img-color</code> for more information.</p>
<h2 id="disp-render-jpg">disp-render-jpg</h2>
<div class="sourceCode" id="cb28"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(disp-render-jpg img-jpg px py)</span></code></pre></div>
<p>Decodes and displays a jpg at position (<code>px</code>,
<code>py</code>).</p>
<p>Example that imports and displays a jpg image.</p>
<div class="sourceCode" id="cb29"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">import</span> <span class="st">&quot;img_test_jpg.jpg&quot;</span> <span class="at">&#39;img-jpg</span>)</span>
<span id="cb29-2"><a href="#cb29-2" aria-hidden="true" tabindex="-1"></a>(disp-render-jpg img-jpg <span class="dv">0</span> <span class="dv">0</span>)</span></code></pre></div>
<h1 id="graphics-library">Graphics library</h1>
<h2 id="img-arc">img-arc</h2>
<div class="sourceCode" id="cb30"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(img-arc img cx cy r ang-s ang-e color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draws an arc with its center at (<code>cx</code>, <code>cy</code>)
and radius r. The arc extends from angle <code>ang-s</code> to
<code>ang-e</code>. Additional attributes are optional.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>filled</li>
<li>thickness</li>
<li>resolution</li>
<li>rounded</li>
</ol>
<p>Example drawing an arc with square corners</p>
<div class="sourceCode" id="cb31"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(img-arc img <span class="dv">100</span> <span class="dv">100</span> <span class="dv">50</span> <span class="dv">160</span> <span class="dv">320</span> <span class="dv">1</span>)</span></code></pre></div>
<p>Example drawing an arc with rounded corners</p>
<div class="sourceCode" id="cb32"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>(img-arc img <span class="dv">100</span> <span class="dv">100</span> <span class="dv">50</span> <span class="dv">160</span> <span class="dv">320</span> <span class="dv">1</span> &#39;(rounded))</span></code></pre></div>
<p>Example drawing a dashed (dotted) arc:</p>
<div class="sourceCode" id="cb33"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(img-arc img <span class="dv">100</span> <span class="dv">100</span> <span class="dv">50</span> <span class="dv">160</span> <span class="dv">320</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span></code></pre></div>
<h2 id="img-blit">img-blit</h2>
<div class="sourceCode" id="cb34"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>(img-blit img-dst img-src px py tc opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draws the source image <code>img-src</code> onto the destination
image <code>img-dst</code> starting with the top left corner of source
at position (<code>px</code>, <code>py</code>) of the destination image.
Additional attributes are optional.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>rotate</li>
<li>scale</li>
</ol>
<p>Example drawing a scaled and rotated image onto an image-buffer.</p>
<div class="sourceCode" id="cb35"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(img-blit img img2 <span class="dv">60</span> <span class="dv">100</span> -<span class="dv">1</span> &#39;(rotate <span class="dv">50</span> <span class="dv">10</span> <span class="dv">60</span>) &#39;(scale <span class="fl">2.2</span>))</span></code></pre></div>
<p>In the example, <code>img2</code> is drawn onto <code>img1</code> at
position (60, 100). <code>img2</code> is rotated around point (50,10),
60 degrees and scaled by a factor 2.2.</p>
<h2 id="img-buffer">img-buffer</h2>
<div class="sourceCode" id="cb36"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>(img-buffer color-fmt width height)</span></code></pre></div>
<p>Creates an image-buffer of size <code>width</code> *
<code>height</code> of colors of format <code>color-fmt</code>.</p>
<p><code>color-fmt</code> can be one of the following symbols:</p>
<ol type="1">
<li>indexed2</li>
<li>indexed4</li>
<li>indexed16</li>
<li>rgb332</li>
<li>rgb565</li>
<li>rgb888</li>
</ol>
<p>Image-buffers are allocated from the lbm-memory, not heap.</p>
<p>Example that creates and names an image-buffer:</p>
<div class="sourceCode" id="cb37"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> img </span>(img-buffer <span class="at">&#39;indexed2</span> <span class="dv">100</span> <span class="dv">100</span>))</span></code></pre></div>
<h2 id="img-buffer-from-bin">img-buffer-from-bin</h2>
<div class="sourceCode" id="cb38"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>(img-buffer-from-bin bin-data)</span></code></pre></div>
<p>Creates an image-buffer from an imported bin file. The binary data
must be a valid representation of a picture and must contain a header
indicating the width, height and color format of the image. The bin
files exported by "Display Tool" in VESC tool follows this format.</p>
<p>Example that imports a bin file and creates an image-buffer:</p>
<div class="sourceCode" id="cb39"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">import</span> <span class="st">&quot;llama.bin&quot;</span> <span class="at">&#39;llama-data</span>)</span>
<span id="cb39-2"><a href="#cb39-2" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> llama </span>(img-buffer-from-bin llama-data))</span></code></pre></div>
<h2 id="img-circle">img-circle</h2>
<div class="sourceCode" id="cb40"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>test-op (img-circle img cx cy r color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draws a circle with its center at (<code>cx</code>, <code>cy</code>)
and radius r in color <code>color</code>. Additional attributes are
optional.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>filled</li>
<li>thickness</li>
<li>resolution</li>
</ol>
<p>Example drawing a filled circle with radius 80:</p>
<div class="sourceCode" id="cb41"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(img-circle img <span class="dv">100</span> <span class="dv">100</span> <span class="dv">80</span> <span class="dv">1</span> &#39;(filled))</span></code></pre></div>
<h2 id="img-circle-sector">img-circle-sector</h2>
<div class="sourceCode" id="cb42"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img cx cy r ang-s ang-e color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draw a circle-sector, a piece of pie. Draws a piece of a circle
positioned at (<code>cx</code>, <code>cy</code>) with radius
<code>r</code>. The piece drawn extends across the angles
<code>ang-s</code> to <code>and-e</code>.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>filled</li>
<li>thickness</li>
<li>resolution</li>
</ol>
<p>Example drawing a thick circle-sector of 45 degrees and radius
80.</p>
<div class="sourceCode" id="cb43"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img <span class="dv">220</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span></code></pre></div>
<h2 id="img-circle-segment">img-circle-segment</h2>
<div class="sourceCode" id="cb44"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img cx cy r ang-s ang-e color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draw a circle-segment. Imagine a line (chord) drawn between the
points of the circle at angle <code>ang-s</code> and <code>ang-e</code>
cutting off a circle segment. The segment is the part of the circle that
is enclosed by the arc from <code>ang-s</code> to <code>ang-e</code> and
the line drawn between those points on the circle.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>filled</li>
<li>thickness</li>
<li>resolution</li>
</ol>
<p>Example drawing a filled circle segment.</p>
<div class="sourceCode" id="cb45"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img <span class="dv">100</span> <span class="dv">100</span> <span class="dv">80</span> <span class="dv">0</span> <span class="dv">100</span> <span class="dv">1</span> &#39;(filled))</span></code></pre></div>
<h2 id="img-clear">img-clear</h2>
<div class="sourceCode" id="cb46"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>(img-clear img opt-color)</span></code></pre></div>
<p>Clears an image-buffer to zero or optionally to a color value given
as argument.</p>
<h2 id="img-color">img-color</h2>
<div class="sourceCode" id="cb47"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(img-color kind arg1 opt-arg2 ... opt-arg4)</span></code></pre></div>
<p>Create a color object for use with <code>disp-render</code>.
<code>img-color</code> takes between 2 and 5 arguments depending on what
kind of color-mapping that is being set up.</p>
<h3 id="regular">regular</h3>
<div class="sourceCode" id="cb48"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>(img-color <span class="at">&#39;regular</span> <span class="dv">0</span>xRRGGBB)</span></code></pre></div>
<p>Creates a regular color for 1-1 mapping between values of an indexed
image and the display color space.</p>
<h3 id="gradient_x">gradient_x</h3>
<div class="sourceCode" id="cb49"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(img-color <span class="at">&#39;gradient_x</span> c0 c1 width offset repeat-type)</span></code></pre></div>
<p>Creates a color gradient in the horizontal direction across the
image. The pixel x position will influence the final color displayed on
the screen. <code>width</code> dictates the amount of pixels it takes to
go from <code>c0</code> to <code>c1</code> (after which the pattern
repeats). <code>offset</code> applies an offset to the starting point of
the interval <code>c0</code> to <code>c1</code>.
<code>repeat-type</code> controls how the gradient repeats outside the
normal range specified by <code>width</code> and <code>offset</code>. Is
either <code>'repeat</code> or <code>'mirrored</code>.</p>
<h3 id="gradient_y">gradient_y</h3>
<div class="sourceCode" id="cb50"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(img-color <span class="at">&#39;gradient_y</span> c0 c1 width offset repeat-type)</span></code></pre></div>
<p>Creates a color gradient in the vertical direction across the image.
The pixel y position will influence the final color displayed on the
screen. <code>width</code> dictates the amount of pixels it takes to go
from <code>c0</code> to <code>c1</code> (after which the pattern
repeats). <code>offset</code> applies an offset to the starting point of
the interval <code>c0</code> to <code>c1</code>.
<code>repeat-type</code> controls how the gradient repeats outside the
normal range specified by <code>width</code> and <code>offset</code>. Is
either <code>'repeat</code> or <code>'mirrored</code>.</p>
<h3 id="gradient_x_pre">gradient_x_pre</h3>
<div class="sourceCode" id="cb51"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(img-color <span class="at">&#39;gradient_x_pre</span> c0 c1 width offset repeat-type)</span></code></pre></div>
<p>See <code>gradient_x</code>. <code>gradient_x_pre</code>
precalculates and buffers the color mapping. This buffer can be modified
using <code>img-color-setpre</code>.</p>
<p>If the <code>repeat-type</code> is <code>'mirrored</code>, the
internal buffer is double in width to store the mirrored half. Width may
not be larger than 512. Larger values will be clamped.</p>
<h3 id="gradient_y_pre">gradient_y_pre</h3>
<div class="sourceCode" id="cb52"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>(img-color <span class="at">&#39;gradient_y_pre</span> c0 c1 width offset repeat-type)</span></code></pre></div>
<p>See <code>gradient_y</code>. <code>gradient_y_pre</code>
precalculates and buffers the color mapping. This buffer can be modified
using <code>img-color-setpre</code></p>
<p>If the <code>repeat-type</code> is <code>'mirrored</code>, the
internal buffer is double in width to store the mirrored half. Width may
not be larger than 512. Larger values will be clamped.</p>
<h2 id="img-color-setpre">img-color-setpre</h2>
<div class="sourceCode" id="cb53"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(img-color-setpre color pos new-color)</span></code></pre></div>
<p>Changes the color at a position in a precalculated color mapping. The
color should be created by <code>img-color</code> and using one of the
precalculated gradient formats (<code>gradient_x_pre</code> or
<code>gradient_y_pre</code>).</p>
<p>The position is relative to the start of the gradient, or in other
words, the <code>offset</code> that the gradient was configured with
doesn't effect how <code>pos</code> is interpreted. <code>pos</code>
must be in the range 0 to width (exclusive) where width is the
<code>width</code> given to <code>img-color</code>.</p>
<p>The mirrored part of the gradient (if present) is not part of the
precalculated buffer, but generated from the normal buffer.</p>
<h2 id="img-color-getpre">img-color-getpre</h2>
<div class="sourceCode" id="cb54"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(img-color-getpre color pos)</span></code></pre></div>
<p>Get the color from a precalculated color mapping. See
<code>img-color-setpre</code>.</p>
<h2 id="img-color-set">img-color-set</h2>
<div class="sourceCode" id="cb55"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>(img-color-set color prop value)</span></code></pre></div>
<p>Set some property of a color generated by <code>img-color</code>.
<code>prop</code> is a symbol (see table below for valid values), and
some properties are only relevant with certain kinds of colors. |
Property | valid values | color kind | | -------------- |
------------------------ | ------------------------------ | |
<code>'color-0</code> | Any integers | <code>regular</code>,
<code>gradient_*</code> | | <code>'color-1</code> | Any integers |
<code>gradient_*</code> | | <code>'width</code> | Any integers |
<code>gradient_*</code> | | <code>'offset</code> | Any integers |
<code>gradient_*</code>, <code>gradient_*_pre</code> | |
<code>'repeat-type</code> | <code>'repeat</code> or
<code>'mirrored</code> | <code>gradient_*</code>,
<code>gradient_*_pre</code> | (rgb colors are just integers, e.g. what
you would get after typing <code>0xffffff</code>)</p>
<p>Invalid properties or values result in type errors.</p>
<h2 id="img-color-get">img-color-get</h2>
<div class="sourceCode" id="cb56"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>(img-color-get color prop)</span></code></pre></div>
<p>Get some property of a color generated by <code>img-color</code>.
Only certain properties are valid for different color kinds, see
<code>img-color-set</code>. An exception is the properties
<code>color-0</code>, <code>color-1</code>, and <code>width</code>,
which precalculated gradients are allowed to <strong>read</strong>, but
not write. Note that this only reads the values which were given when
the gradient was created. The actual colors of the buffer may have been
set to different colors using <code>img-color-setpre</code>.</p>
<h2 id="img-dims">img-dims</h2>
<div class="sourceCode" id="cb57"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(img-dims img)</span></code></pre></div>
<p>Returns the dimensions of the image, its width and height, as a
list.</p>
<h2 id="img-line">img-line</h2>
<div class="sourceCode" id="cb58"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(img-line img x1 y1 x2 y2 color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draws a line between points (<code>x1</code>, <code>y1</code>) and
(<code>x2</code>, <code>y2</code>) in color <code>color</code>.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>thickness</li>
</ol>
<p>Example that draws a thick dashed (dotted) line:</p>
<div class="sourceCode" id="cb59"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(img-line img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">120</span> <span class="dv">220</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>) &#39;(thickness <span class="dv">3</span>))</span></code></pre></div>
<h2 id="img-rectangle">img-rectangle</h2>
<div class="sourceCode" id="cb60"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(img-rectangle img x y width height color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draws a rectangle with its upper left corner in point
(<code>x</code>,<code>y</code>) and width <code>width</code> and height
<code>height</code> in color <code>color</code>.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>filled</li>
<li>rounded</li>
<li>thickness</li>
<li>resolution</li>
</ol>
<p>Example drawing a filled rectangle with rounded corners:</p>
<div class="sourceCode" id="cb61"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">120</span> <span class="dv">180</span> <span class="dv">1</span> &#39;(filled) &#39;(rounded <span class="dv">45</span>) )</span></code></pre></div>
<p>Note that the argument to rounded should be at most 45 degrees.</p>
<h2 id="img-setpix">img-setpix</h2>
<div class="sourceCode" id="cb62"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>(img-setpix x y color)</span></code></pre></div>
<p>Set pixel (<code>x</code>,<code>y</code>) in image <code>img</code>
to color <code>color</code>.</p>
<p>example that sets a pixel:</p>
<div class="sourceCode" id="cb63"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>(img-setpix <span class="dv">10</span> <span class="dv">10</span> <span class="dv">1</span>)</span></code></pre></div>
<h2 id="img-text">img-text</h2>
<div class="sourceCode" id="cb64"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>(img-text img x y fg bg font <span class="kw">str</span>)</span>
<span id="cb64-2"><a href="#cb64-2" aria-hidden="true" tabindex="-1"></a>(img-text img x y colors font <span class="kw">str</span>)</span></code></pre></div>
<p>Draws the text from the string <code>str</code> at position
(<code>x</code>,<code>y</code>) using font-data <code>font</code> with
foreground color <code>fg</code> and background color <code>bg</code>.
Alternatively, a list of colors can be provided instead of the
foreground and background. The color-list is needed for 2-bit
antialiased fonts and should contain 4 colors then.</p>
<p>fonts can be loaded using the import facility.</p>
<p>Example that imports a font and draws some text to an
image-buffer:</p>
<div class="sourceCode" id="cb65"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">import</span> <span class="st">&quot;font_16_24_all.bin&quot;</span> <span class="at">&#39;font-small</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>(img-text img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">1</span> <span class="dv">0</span> font-small <span class="st">&quot;LispBM&quot;</span>)</span></code></pre></div>
<h2 id="img-triangle">img-triangle</h2>
<div class="sourceCode" id="cb66"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>(img-triangle img x1 y1 x2 y2 x3 y3 color opt-attr1 ... opt-attrN)</span></code></pre></div>
<p>Draws the triangle (<code>x1</code>,<code>y1</code>),
(<code>x2</code>,<code>y2</code>), (<code>x3</code>,<code>y3</code>) in
color <code>color</code>.</p>
<p>Applicable attributes:</p>
<ol type="1">
<li>dotted</li>
<li>filled</li>
<li>thickness</li>
</ol>
<p>Example that draws a filled triangle:</p>
<div class="sourceCode" id="cb67"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(img-triangle img <span class="dv">30</span> <span class="dv">60</span> <span class="dv">160</span> <span class="dv">120</span> <span class="dv">10</span> <span class="dv">220</span> <span class="dv">1</span> &#39;(filled))</span></code></pre></div>
<h1 id="attribute-reference">Attribute reference</h1>
<h2 id="lines">Lines</h2>
<div class="sourceCode" id="cb68"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(img-line img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">300</span> <span class="dv">50</span> <span class="dv">1</span>)</span>
<span id="cb68-2"><a href="#cb68-2" aria-hidden="true" tabindex="-1"></a>(img-line img <span class="dv">10</span> <span class="dv">30</span> <span class="dv">300</span> <span class="dv">70</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb68-3"><a href="#cb68-3" aria-hidden="true" tabindex="-1"></a>(img-line img <span class="dv">10</span> <span class="dv">50</span> <span class="dv">300</span> <span class="dv">90</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb68-4"><a href="#cb68-4" aria-hidden="true" tabindex="-1"></a>(img-line img <span class="dv">10</span> <span class="dv">70</span> <span class="dv">300</span> <span class="dv">110</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>) &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb68-5"><a href="#cb68-5" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/line_attributes.jpg"
alt="Lines with different attributes" /></p>
<h2 id="cirlces">Cirlces</h2>
<div class="sourceCode" id="cb69"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(img-circle img <span class="dv">40</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">1</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>(img-circle img <span class="dv">130</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>(img-circle img <span class="dv">220</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb69-4"><a href="#cb69-4" aria-hidden="true" tabindex="-1"></a>(img-circle img <span class="dv">40</span> <span class="dv">130</span> <span class="dv">40</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>) &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb69-5"><a href="#cb69-5" aria-hidden="true" tabindex="-1"></a>(img-circle img <span class="dv">130</span> <span class="dv">130</span> <span class="dv">40</span> <span class="dv">1</span> &#39;(filled))</span>
<span id="cb69-6"><a href="#cb69-6" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/circle_attributes.jpg"
alt="Circles with different attributes" /></p>
<h2 id="circle-sectors">Circle sectors</h2>
<div class="sourceCode" id="cb70"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img <span class="dv">40</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span>)</span>
<span id="cb70-2"><a href="#cb70-2" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img <span class="dv">130</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb70-3"><a href="#cb70-3" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img <span class="dv">220</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb70-4"><a href="#cb70-4" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img <span class="dv">40</span> <span class="dv">130</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>) &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb70-5"><a href="#cb70-5" aria-hidden="true" tabindex="-1"></a>(img-circle-sector img <span class="dv">130</span> <span class="dv">130</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(filled))</span>
<span id="cb70-6"><a href="#cb70-6" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/circle_sector_attributes.jpg"
alt="Circle-sectors with different attributes" /></p>
<h2 id="circle-segments">Circle segments</h2>
<div class="sourceCode" id="cb71"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img <span class="dv">40</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span>)</span>
<span id="cb71-2"><a href="#cb71-2" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img <span class="dv">130</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb71-3"><a href="#cb71-3" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img <span class="dv">220</span> <span class="dv">40</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb71-4"><a href="#cb71-4" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img <span class="dv">40</span> <span class="dv">130</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>) &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb71-5"><a href="#cb71-5" aria-hidden="true" tabindex="-1"></a>(img-circle-segment img <span class="dv">130</span> <span class="dv">130</span> <span class="dv">40</span> <span class="dv">90</span> <span class="dv">200</span> <span class="dv">1</span> &#39;(filled))</span>
<span id="cb71-6"><a href="#cb71-6" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/circle_segment_attributes.jpg"
alt="Circle-segments with different attributes" /></p>
<h2 id="triangles">Triangles</h2>
<div class="sourceCode" id="cb72"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>(img-triangle img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">80</span> <span class="dv">20</span> <span class="dv">40</span> <span class="dv">80</span> <span class="dv">1</span>)</span>
<span id="cb72-2"><a href="#cb72-2" aria-hidden="true" tabindex="-1"></a>(img-triangle img <span class="dv">100</span> <span class="dv">10</span> <span class="dv">170</span> <span class="dv">20</span> <span class="dv">130</span> <span class="dv">80</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb72-3"><a href="#cb72-3" aria-hidden="true" tabindex="-1"></a>(img-triangle img <span class="dv">190</span> <span class="dv">10</span> <span class="dv">260</span> <span class="dv">20</span> <span class="dv">220</span> <span class="dv">80</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb72-4"><a href="#cb72-4" aria-hidden="true" tabindex="-1"></a>(img-triangle img <span class="dv">10</span> <span class="dv">100</span> <span class="dv">80</span> <span class="dv">110</span> <span class="dv">40</span> <span class="dv">170</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>) &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb72-5"><a href="#cb72-5" aria-hidden="true" tabindex="-1"></a>(img-triangle img <span class="dv">100</span> <span class="dv">100</span> <span class="dv">170</span> <span class="dv">110</span> <span class="dv">130</span> <span class="dv">170</span> <span class="dv">1</span> &#39;(filled))</span>
<span id="cb72-6"><a href="#cb72-6" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/triangle_attributes.jpg"
alt="Triangles with different attributes" /></p>
<h2 id="rectangles">Rectangles</h2>
<div class="sourceCode" id="cb73"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">10</span> <span class="dv">10</span> <span class="dv">70</span> <span class="dv">70</span> <span class="dv">1</span>)</span>
<span id="cb73-2"><a href="#cb73-2" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">90</span> <span class="dv">10</span> <span class="dv">70</span> <span class="dv">70</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>))</span>
<span id="cb73-3"><a href="#cb73-3" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">170</span> <span class="dv">10</span> <span class="dv">70</span> <span class="dv">70</span> <span class="dv">1</span> &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb73-4"><a href="#cb73-4" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">10</span> <span class="dv">90</span> <span class="dv">70</span> <span class="dv">70</span> <span class="dv">1</span> &#39;(dotted <span class="dv">15</span> <span class="dv">15</span>) &#39;(thickness <span class="dv">3</span>))</span>
<span id="cb73-5"><a href="#cb73-5" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">90</span> <span class="dv">90</span> <span class="dv">70</span> <span class="dv">70</span> <span class="dv">1</span> &#39;(filled))</span>
<span id="cb73-6"><a href="#cb73-6" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">170</span> <span class="dv">90</span> <span class="dv">70</span> <span class="dv">70</span> <span class="dv">1</span> &#39;(rounded <span class="dv">10</span>))</span>
<span id="cb73-7"><a href="#cb73-7" aria-hidden="true" tabindex="-1"></a>(img-rectangle img <span class="dv">10</span> <span class="dv">170</span> <span class="dv">70</span> <span class="dv">60</span> <span class="dv">1</span> &#39;(rounded <span class="dv">10</span>) &#39;(filled))</span>
<span id="cb73-8"><a href="#cb73-8" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/rectangle_attributes.jpg"
alt="Rectangles with different attributes" /></p>
<h2 id="bliting">Bliting</h2>
<div class="sourceCode" id="cb74"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">import</span> <span class="st">&quot;llama.bin&quot;</span> <span class="at">&#39;llama-data</span>)</span>
<span id="cb74-2"><a href="#cb74-2" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> llama </span>(img-buffer-from-bin llama-data))</span>
<span id="cb74-3"><a href="#cb74-3" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-4"><a href="#cb74-4" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> llama-dims </span>(img-dims llama))</span>
<span id="cb74-5"><a href="#cb74-5" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> llama-w </span>(<span class="kw">first</span> llama-dims))</span>
<span id="cb74-6"><a href="#cb74-6" aria-hidden="true" tabindex="-1"></a>(<span class="bu">def</span><span class="fu"> llama-h </span>(<span class="kw">second</span> llama-dims))</span>
<span id="cb74-7"><a href="#cb74-7" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb74-8"><a href="#cb74-8" aria-hidden="true" tabindex="-1"></a>(img-blit img llama <span class="dv">10</span> <span class="dv">10</span> -<span class="dv">1</span>)</span>
<span id="cb74-9"><a href="#cb74-9" aria-hidden="true" tabindex="-1"></a>(img-blit img llama <span class="dv">120</span> <span class="dv">10</span> -<span class="dv">1</span> `(rotate ,(<span class="kw">/</span> llama-w <span class="dv">2</span>) ,(<span class="kw">/</span> llama-h <span class="dv">2</span>) <span class="dv">45</span>))</span>
<span id="cb74-10"><a href="#cb74-10" aria-hidden="true" tabindex="-1"></a>(img-blit img llama <span class="dv">10</span> <span class="dv">120</span> -<span class="dv">1</span> &#39;(scale <span class="fl">0.5</span>))</span>
<span id="cb74-11"><a href="#cb74-11" aria-hidden="true" tabindex="-1"></a>(img-blit img llama <span class="dv">120</span> <span class="dv">120</span> -<span class="dv">1</span> &#39;(scale <span class="fl">1.5</span>))</span>
<span id="cb74-12"><a href="#cb74-12" aria-hidden="true" tabindex="-1"></a>(img-blit img llama <span class="dv">20</span> <span class="dv">60</span> -<span class="dv">1</span> &#39;(scale <span class="fl">1.5</span>) `(rotate ,(<span class="kw">/</span> llama-w <span class="dv">2</span>) ,(<span class="kw">/</span> llama-h <span class="dv">2</span>) <span class="dv">45</span>)) </span>
<span id="cb74-13"><a href="#cb74-13" aria-hidden="true" tabindex="-1"></a>(disp-render img <span class="dv">0</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="bn">0x000000</span> <span class="bn">0xFF0000</span>))</span></code></pre></div>
<p><img src="./resources/blit_attributes.jpg"
alt="Bliting with different attributes" /></p>
</div> <!-- Close container -->

<footer style="margin-top: 50px; padding: 20px; background: #f8f9fa; border-top: 1px solid #dee2e6; text-align: center;">
  <p>
    <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê Back to Reference Manual Index</a> |
    <a href="https://www.lispbm.com/" style="color: #007bff; text-decoration: none;">LispBM Home</a>
  </p>

  <p>
    Please contact me with questions, suggestions or feedback at blog
    (dot) joel (dot) svensson (at) gmail (dot) com or join the
    <a href="https://discord.gg/KgD4WcnFjv">Discord server</a>.
  </p>

  <p>&copy; Copyright 2025 Bo Joel Svensson</p>

  <p><small>This page was generated using <a href="https://pandoc.org/">Pandoc</a>.</small></p>
</footer>

</body>
</html>
