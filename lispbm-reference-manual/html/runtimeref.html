<!DOCTYPE html>

<html lang="en-US">

<head>
  <meta charset="UTF-8">
  <meta name="description" content="LispBM Reference Documentation - LispBM Runtime Extensions Reference Manual">
  <meta name="keywords" content="lispbm, lisp, reference, documentation, embedded lisp, microcontroller, LispBM Runtime Extensions Reference Manual">
  <meta name="author" content="Bo Joel Svensson">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO Meta Tags -->

  <link rel="canonical" href="https://www.lispbm.com/lispbm-reference-manual/runtimeref/" />
  <meta name="robots" content="index, follow">

  <!-- Open Graph Meta Tags -->

  <meta property="og:title" content="LispBM Runtime Extensions Reference Manual">
  <meta property="og:description" content="LispBM Reference Documentation - LispBM Runtime Extensions Reference Manual">
  <meta property="og:image" content="https://www.lispbm.com/images/lispbm_llama_small.png">
  <meta property="og:url" content="https://www.lispbm.com/lispbm-reference-manual/runtimeref/">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="LispBM">

  <!-- Twitter Card Meta Tags -->

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="LispBM Runtime Extensions Reference Manual">
  <meta name="twitter:description" content="LispBM Reference Documentation - LispBM Runtime Extensions Reference Manual">
  <meta name="twitter:image" content="https://www.lispbm.com/images/lispbm_llama_small.png">

  <link rel="apple-touch-icon" sizes="180x180" href="https://www.lispbm.com/ico/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://www.lispbm.com/ico/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://www.lispbm.com/ico/favicon-16x16.png">
  <link rel="shortcut icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" type="image/x-icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="manifest" href="https://www.lispbm.com/ico/site.webmanifest">

  <link rel="stylesheet" href="reference.css">

  <title>LispBM Runtime Extensions Reference Manual</title>
</head>

<body data-pagefind-filter="Platform=Core LispBM, Document=Runtimeref">

<div style="max-width: 900px; margin: 0 auto; padding: 20px;">
  <div style="margin-bottom: 20px;">
    <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê Back to Reference Manual Index</a>
  </div>

<!-- Content starts here -->

<h1 id="lispbm-runtime-extensions-reference-manual">LispBM Runtime
Extensions Reference Manual</h1>
<p>The runtime extensions, if present, can be either compiled in a
minimal or a full mode. In the minimal mode only
<code>set-eval-quota</code> is present. Minimal mode is the default when
compiling LBM. To get the full mode the <code>-DFULL_RTS_LIB</code> flag
must be used when compiling.</p>
<h2 id="errors">Errors</h2>
<h3 id="hide-trapped-error">hide-trapped-error</h3>
<p>The default behavior is to print error messages even if the error is
trapped. Trapped errors can be hidden by calling this function at the
beginning of a program.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb1"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(hide-trapped-error)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb2"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="show-trapped-errors">show-trapped-errors</h3>
<p>If you have hidden trapped errors they can be toggled back to being
showed again using this function.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb3"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(show-trapped-error)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb4"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="environments">Environments</h2>
<h3 id="env-get">env-get</h3>
<p><code>env-get</code> can be used to reify, turn into value, parts of
the global environment. The global environment is stored as a hashtable
and an index into this hashtable is used to extract the bindings stored
under that hash.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb5"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">0</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb6"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a>((chapter-environments section <span class="dv">2</span> <span class="st">&quot;Environments&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;env-get&quot;</span> ((para (<span class="st">&quot;`env-get` can be used to reify, turn into value, parts of the global environment.&quot;</span> <span class="st">&quot;The global environment is stored as a hashtable and an index into this hashtable&quot;</span> <span class="st">&quot;i</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb7"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">1</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb8"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>((symbol-table-size <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size&quot;</span> ((para (<span class="st">&quot;`symtab-size` returns the size of the symbol table in bytes.&quot;</span>)) (code ((symtab-size))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (code-entry-ref closure (code) (str-merge <span class="st">&quot;[`&quot;</span> code <span class="st">&quot;`](#&quot;</span> (<span class="kw">or</span> (rest-args <span class="dv">0</span>) code) <span class="st">&quot;)&quot;</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb9"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">2</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb10"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a>((symbol-table-size-flash <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size-flash&quot;</span> ((para (<span class="st">&quot;`symtab-size-flash` returns the size in bytes of the portion of the symbol table&quot;</span> <span class="st">&quot;that is stored in flash.&quot;</span>)) (code ((symtab-size-flash))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (intersperse closure </span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb11"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">3</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb12"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>((symbol-table-size-names <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size-names&quot;</span> ((para (<span class="st">&quot;`symtab-size-names` returns the size in bytes of the string names stored in&quot;</span> <span class="st">&quot;the symbol table.&quot;</span>)) (code ((symtab-size-names))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (bullet closure (ss) (verb (<span class="kw">map</span> (</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb13"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">4</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb14"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>((symbol-table-size-names-flash <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size-names-flash&quot;</span> ((para (<span class="st">&quot;`symtab-size-names` returns the size in bytes of the string names stored in&quot;</span> <span class="st">&quot;the symbol table in flash.&quot;</span>)) (code ((symtab-size-names-flash))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (set-p</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb15"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">5</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb16"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a>((chapter-symboltable section <span class="dv">2</span> <span class="st">&quot;Symbol table&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size&quot;</span> ((para (<span class="st">&quot;`symtab-size` returns the size of the symbol table in bytes.&quot;</span>)) (code ((symtab-size))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size-flash&quot;</span> ((para (<span class="st">&quot;`symtab-</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb17"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">6</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb18"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>((version <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;lbm-version&quot;</span> ((para (<span class="st">&quot;`lbm-version` returns the version of the lbm runtime system.&quot;</span>)) (code ((lbm-version))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (code-raw closure (c) (<span class="kw">list</span> (quote code-raw) c) <span class="va">nil</span>) (render-program-disp-res-pairs closure (ren</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb19"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">7</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb20"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>((arch <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;is-64bit&quot;</span> ((para (<span class="st">&quot;`is-64bit` returns true if a 64bit version of lbm is running.&quot;</span>)) (code ((is<span class="dv">-64</span>bit))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (defun macro (<span class="kw">name</span> args body) (me-defun <span class="kw">name</span> args body)) (render-code-raw-table closure (rend c) (progn </span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb21"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">8</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb22"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a>((word <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;word-size&quot;</span> ((para (<span class="st">&quot;`word-size` returns 4 on 32bit LBM  and 8 on 64bits.&quot;</span>)) (code ((word-size))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (code-png closure (img colors c) (<span class="kw">list</span> (quote code-png) img colors c) <span class="va">nil</span>) (pretty-ind closure (n c) (match c (</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb23"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">9</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb24"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>((chapter-versioning section <span class="dv">2</span> <span class="st">&quot;Version&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;lbm-version&quot;</span> ((para (<span class="st">&quot;`lbm-version` returns the version of the lbm runtime system.&quot;</span>)) (code ((lbm-version))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;is-64bit&quot;</span> ((para (<span class="st">&quot;`is-64bit` returns true</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb25"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">10</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb26"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a>((hide-em <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;hide-trapped-error&quot;</span> ((para (<span class="st">&quot;The default behavior is to print error messages even if the error is trapped.&quot;</span> <span class="st">&quot;Trapped errors can be hidden by calling this function at the beginning of a program.&quot;</span>)) (code ((hide-trapped-error)))</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb27"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">11</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb28"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>((show-em <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;show-trapped-errors&quot;</span> ((para (<span class="st">&quot;If you have hidden trapped errors they can be toggled back to being showed again&quot;</span> <span class="st">&quot;using this function.&quot;</span>)) (code ((show-trapped-error))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (evaluation-quota <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb29"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">12</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb30"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>((chapter-errors section <span class="dv">2</span> <span class="st">&quot;Errors&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;hide-trapped-error&quot;</span> ((para (<span class="st">&quot;The default behavior is to print error messages even if the error is trapped.&quot;</span> <span class="st">&quot;Trapped errors can be hidden by calling this function at the beginning of a program.&quot;</span>)) (</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb31"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">13</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb32"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a>((manual (section <span class="dv">1</span> <span class="st">&quot;LispBM Runtime Extensions Reference Manual&quot;</span> ((para (<span class="st">&quot;The runtime extensions, if present, can be either compiled&quot;</span> <span class="st">&quot;in a minimal or a full mode.&quot;</span> <span class="st">&quot;In the minimal mode only `set-eval-quota` is present.&quot;</span> <span class="st">&quot;Minimal mode is the default when c</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb33"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">14</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb34"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a>((render-manual closure <span class="va">nil</span> (<span class="kw">let</span> ((h (fopen <span class="st">&quot;runtimeref.md&quot;</span> <span class="st">&quot;w&quot;</span>)) (r (lambda (s) (fwrite-str h s)))) (progn (gc) (var t0 (systime)) (render r manual) (<span class="kw">print</span> <span class="st">&quot;Runtime reference manual was generated in &quot;</span> (secs-since t0) <span class="st">&quot; seconds&quot;</span>))) <span class="va">nil</span>) (program-disp closu</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb35"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">15</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb36"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>((program-gif closure (c) (<span class="kw">list</span> (quote program-gif) c) <span class="va">nil</span>) (render-program-disp-gif-pairs closure (rend cs) (match cs (<span class="va">nil</span> t) (((? x) ? xs) (<span class="kw">let</span> ((x-str (pretty (quote t) <span class="dv">0</span> (car (cdr x)))) (x-code (car (cdr x))) (gif (gif-file)) (res (eval-animation gif x</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb37"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">16</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb38"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a>((chapter-threads section <span class="dv">2</span> <span class="st">&quot;Threads&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;mailbox-get&quot;</span> ((para (<span class="st">&quot;`mailbox-get` returns the mailbox contents of a thread as a list.&quot;</span> <span class="st">&quot;The form of a `mailbox-get` expression is `(mailbox-get pid)`.&quot;</span> <span class="st">&quot;Note that `mailbox-get` does **NOT** empt</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb39"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">17</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb40"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a>((num-free <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;mem-num-free&quot;</span> ((para (<span class="st">&quot;`mem-num-free` returns the number of free words in the LBM memory.&quot;</span> <span class="st">&quot;This is the memory where arrays and strings are stored.&quot;</span>)) (code ((mem-num-free))) <span class="va">nil</span>)) <span class="kw">newline</span> hline))</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb41"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">18</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb42"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>((longest-free <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;mem-longest-free&quot;</span> ((para (<span class="st">&quot;`mem-longest-free` returns the length in words of the longest&quot;</span> <span class="st">&quot;consecutive sequence of free words in the LBM memory.&quot;</span>)) (code ((mem-num-free))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (table closure (header data)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb43"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">19</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb44"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a>((memory-size <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;mem-size&quot;</span> ((para (<span class="st">&quot;`mem-size` returns the size of the LBM memory.&quot;</span>)) (code ((mem-size))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (semantic-step closure (c1 c2 prop) (<span class="kw">list</span> (quote semantic-step) c1 c2 prop) <span class="va">nil</span>))</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb45"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">20</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb46"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a>((heap-state <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;lbm-heap-state&quot;</span> ((para (<span class="st">&quot;`lbm-heap-state` can be used to query information about heap usage.&quot;</span>)) (code ((lbm-heap-state (quote get-heap-size)) (lbm-heap-state (quote get-heap-bytes)) (lbm-heap-state (quote get-num-alloc-cell</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb47"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">21</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb48"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a>((chapter-memory section <span class="dv">2</span> <span class="st">&quot;Memory&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;mem-num-free&quot;</span> ((para (<span class="st">&quot;`mem-num-free` returns the number of free words in the LBM memory.&quot;</span> <span class="st">&quot;This is the memory where arrays and strings are stored.&quot;</span>)) (code ((mem-num-free))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (n</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb49"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">22</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb50"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>((gc-stack <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;set-gc-stack-size&quot;</span> ((para (<span class="st">&quot;With `set-gc-stack-size` you can change the size of the stack used for heap traversal&quot;</span> <span class="st">&quot;by the garbage collector.&quot;</span>)) (code ((set-gc-stack-size <span class="dv">100</span>))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (png-count . <span class="dv">0</span>) (pretty-al</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb51"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">23</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb52"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a>((gc-is-always-gc <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;is-always-gc&quot;</span> ((para (<span class="st">&quot;The `is-always-gc` predicate is true if LBM is built with the LBM_ALWAYS_GC debug flag.&quot;</span>)) (code ((is-always-gc))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (pic-prefix . [<span class="dv">0</span>]) (str-merge-list closure (strings) (match</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb53"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">24</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb54"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>((chapter-gc section <span class="dv">2</span> <span class="st">&quot;GC&quot;</span> ((<span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;set-gc-stack-size&quot;</span> ((para (<span class="st">&quot;With `set-gc-stack-size` you can change the size of the stack used for heap traversal&quot;</span> <span class="st">&quot;by the garbage collector.&quot;</span>)) (code ((set-gc-stack-size <span class="dv">100</span>))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (newlin</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb55"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">25</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb56"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a>((environment-get <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;env-get&quot;</span> ((para (<span class="st">&quot;`env-get` can be used to reify, turn into value, parts of the global environment.&quot;</span> <span class="st">&quot;The global environment is stored as a hashtable and an index into this hashtable&quot;</span> <span class="st">&quot;is used to extract the bindings s</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb57"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">26</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb58"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>((environment-set <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;env-set&quot;</span> ((para (<span class="st">&quot;`env-set` destructively sets an entry in the global environment hashtable.&quot;</span>)) (program (((<span class="kw">if</span> (eq (env-get <span class="dv">1</span>) <span class="va">nil</span>) (env-set <span class="dv">1</span> (<span class="kw">list</span> (quote (a . <span class="dv">75</span>))))) (env-get <span class="dv">1</span>)))) (para (<span class="st">&quot;Note that in the example c</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb59"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">27</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb60"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>((end) (render-code-table closure (rend c) (progn (rend <span class="st">&quot;&lt;table&gt;</span><span class="sc">\n</span><span class="st">&quot;</span>) (rend <span class="st">&quot;&lt;tr&gt;</span><span class="sc">\n</span><span class="st">&quot;</span>) (rend <span class="st">&quot;&lt;td&gt; Example &lt;/td&gt; &lt;td&gt; Result &lt;/td&gt;</span><span class="sc">\n</span><span class="st">&quot;</span>) (rend <span class="st">&quot;&lt;/tr&gt;</span><span class="sc">\n</span><span class="st">&quot;</span>) (render-code-res-pairs rend c) (rend <span class="st">&quot;&lt;/table&gt;</span><span class="sc">\n\n</span><span class="st">&quot;</span>)) <span class="va">nil</span>) (frame-max . <span class="dv">0</span>))</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb61"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">28</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb62"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a>((environment-drop <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;env-drop&quot;</span> ((para (<span class="st">&quot;drop a binding from an environment.&quot;</span>)) (code ((env-drop (quote a) (quote ((a . <span class="dv">10</span>) (b . <span class="dv">20</span>) (c . <span class="dv">30</span>)))))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (s+ closure (s ss) (<span class="kw">cons</span> s ss) <span class="va">nil</span>) (render-it closure (rend ss) (match</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb63"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">29</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb64"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a>((ref-entry closure (<span class="kw">str</span> strings-or-tags) (<span class="kw">let</span> ((tags (<span class="kw">and</span> (rest-args <span class="dv">0</span>) strings-or-tags)) (strings (<span class="kw">or</span> (rest-args <span class="dv">0</span>) strings-or-tags))) (<span class="kw">list</span> (quote <span class="kw">newline</span>) (<span class="kw">if</span> tags (tagged-section <span class="dv">3</span> <span class="kw">str</span> tags strings) (section <span class="dv">3</span> <span class="kw">str</span> strings)) (quote <span class="kw">newline</span>) (quote hlin</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb65"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">30</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb66"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a>((local-environment-get <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;local-env-get&quot;</span> ((para (<span class="st">&quot;`local-env-get` can be used to reify, turn into value, the local environment.&quot;</span>)) (code ((local-env-get))) (program (((<span class="kw">let</span> ((a <span class="dv">50</span>)) (local-env-get))))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (render closure </span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb67"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">31</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb68"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>((global-environment-size <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;global-env-size&quot;</span> ((para (<span class="st">&quot;Get the size (in number of bindings) of the global env.&quot;</span>)) (code ((global-env-size))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (render-code-disp-pairs closure (rend cs) (match cs (<span class="va">nil</span> t) (((? x) ? xs) (le</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="env-set">env-set</h3>
<p><code>env-set</code> destructively sets an entry in the global
environment hashtable.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb69"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">if</span> (eq (env-get <span class="dv">1</span>) <span class="va">nil</span>) (env-set <span class="dv">1</span> (<span class="kw">list</span> &#39;(a . <span class="dv">75</span>))))</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>(env-get <span class="dv">1</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb70"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a>((symbol-table-size <span class="kw">newline</span> (section <span class="dv">3</span> <span class="st">&quot;symtab-size&quot;</span> ((para (<span class="st">&quot;`symtab-size` returns the size of the symbol table in bytes.&quot;</span>)) (code ((symtab-size))) <span class="va">nil</span>)) <span class="kw">newline</span> hline) (code-entry-ref closure (code) (str-merge <span class="st">&quot;[`&quot;</span> code <span class="st">&quot;`](#&quot;</span> (<span class="kw">or</span> (rest-args <span class="dv">0</span>) code) <span class="st">&quot;)&quot;</span></span></code></pre></div>
</td>
</tr>
</table>

<p>Note that in the example code above there is no guarantee that the
symbol <code>a</code> actually hashes to index 1 in the environment
table. So <code>a</code> is most likely impossible to look up from this
environment. The use case for <code>env-set</code> and
<code>env-get</code> are rather that they are together. Use
<code>env-get</code> to extract index <code>i</code> from the table,
then modify it in some way and end by using <code>env-set</code> to the
same index <code>i</code>.</p>
<hr />
<h3 id="env-drop">env-drop</h3>
<p>drop a binding from an environment.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb71"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb71-1"><a href="#cb71-1" aria-hidden="true" tabindex="-1"></a>(env-drop <span class="at">&#39;a</span> &#39;((a . <span class="dv">10</span>) (b . <span class="dv">20</span>) (c . <span class="dv">30</span>)))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb72"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb72-1"><a href="#cb72-1" aria-hidden="true" tabindex="-1"></a>((b . <span class="dv">20</span>) (c . <span class="dv">30</span>))</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="local-env-get">local-env-get</h3>
<p><code>local-env-get</code> can be used to reify, turn into value, the
local environment.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb73"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb73-1"><a href="#cb73-1" aria-hidden="true" tabindex="-1"></a>(local-env-get)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb74"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb74-1"><a href="#cb74-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb75"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb75-1"><a href="#cb75-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">let</span> ((a <span class="dv">50</span>))</span>
<span id="cb75-2"><a href="#cb75-2" aria-hidden="true" tabindex="-1"></a>     (local-env-get))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb76"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb76-1"><a href="#cb76-1" aria-hidden="true" tabindex="-1"></a>((a . <span class="dv">50</span>) (res-str . $placeholder) (res (a . <span class="dv">50</span>) (res-str . $placeholder) (res (a . <span class="dv">50</span>) (res-str . $placeholder) (res (a . <span class="dv">50</span>) (res-str . $placeholder) (res (a . <span class="dv">50</span>) (res-str . $placeholder) (res (a . <span class="dv">50</span>) (res-str . $placeholder) (res (a . <span class="dv">50</span>) (res-str . $</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="global-env-size">global-env-size</h3>
<p>Get the size (in number of bindings) of the global env.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb77"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(global-env-size)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb78"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a><span class="dv">103</span>u</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="gc">GC</h2>
<h3 id="set-gc-stack-size">set-gc-stack-size</h3>
<p>With <code>set-gc-stack-size</code> you can change the size of the
stack used for heap traversal by the garbage collector.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb79"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(set-gc-stack-size <span class="dv">100</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb80"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="is-always-gc">is-always-gc</h3>
<p>The <code>is-always-gc</code> predicate is true if LBM is built with
the LBM_ALWAYS_GC debug flag.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb81"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(is-always-gc)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb82"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="memory">Memory</h2>
<h3 id="mem-num-free">mem-num-free</h3>
<p><code>mem-num-free</code> returns the number of free words in the LBM
memory. This is the memory where arrays and strings are stored.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb83"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>(mem-num-free)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb84"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a><span class="dv">254950</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="mem-longest-free">mem-longest-free</h3>
<p><code>mem-longest-free</code> returns the length in words of the
longest consecutive sequence of free words in the LBM memory.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb85"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(mem-num-free)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb86"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a><span class="dv">254886</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="mem-size">mem-size</h3>
<p><code>mem-size</code> returns the size of the LBM memory.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb87"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>(mem-size)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb88"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="dv">262144</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="lbm-heap-state">lbm-heap-state</h3>
<p><code>lbm-heap-state</code> can be used to query information about
heap usage.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb89"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-heap-size</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb90"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="dv">100000</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb91"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-heap-bytes</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb92"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="dv">800000</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb93"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-num-alloc-cells</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb94"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a><span class="dv">13781</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb95"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-num-alloc-arrays</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb96"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a><span class="dv">769</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb97"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-gc-num</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb98"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb99"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-gc-num-marked</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb100"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4587</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb101"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-gc-num-recovered-cells</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb102"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="dv">95413</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb103"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-gc-num-recovered-arrays</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb104"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb105"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-gc-num-least-free</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb106"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a><span class="dv">95413</span>u</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb107"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>(lbm-heap-state <span class="at">&#39;get-gc-num-last-free</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb108"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a><span class="dv">95413</span>u</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="scheduling">Scheduling</h2>
<h3 id="set-eval-quota">set-eval-quota</h3>
<p><code>set-eval-quota</code> sets the number of evaluation steps that
is given to each context when given turn to execute by the round-robin
scheduler.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb109"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(set-eval-quota <span class="dv">30</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb110"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="symbol-table">Symbol table</h2>
<h3 id="symtab-size">symtab-size</h3>
<p><code>symtab-size</code> returns the size of the symbol table in
bytes.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb111"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(symtab-size)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb112"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>u</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="symtab-size-flash">symtab-size-flash</h3>
<p><code>symtab-size-flash</code> returns the size in bytes of the
portion of the symbol table that is stored in flash.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb113"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(symtab-size-flash)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb114"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2188</span>u</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="symtab-size-names">symtab-size-names</h3>
<p><code>symtab-size-names</code> returns the size in bytes of the
string names stored in the symbol table.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb115"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb115-1"><a href="#cb115-1" aria-hidden="true" tabindex="-1"></a>(symtab-size-names)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb116"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb116-1"><a href="#cb116-1" aria-hidden="true" tabindex="-1"></a><span class="dv">0</span>u</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="symtab-size-names-flash">symtab-size-names-flash</h3>
<p><code>symtab-size-names</code> returns the size in bytes of the
string names stored in the symbol table in flash.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb117"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb117-1"><a href="#cb117-1" aria-hidden="true" tabindex="-1"></a>(symtab-size-names-flash)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb118"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb118-1"><a href="#cb118-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2188</span>u</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="threads">Threads</h2>
<h3 id="mailbox-get">mailbox-get</h3>
<p><code>mailbox-get</code> returns the mailbox contents of a thread as
a list. The form of a <code>mailbox-get</code> expression is
<code>(mailbox-get pid)</code>. Note that <code>mailbox-get</code> does
<strong>NOT</strong> empty the mailbox.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb119"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb119-1"><a href="#cb119-1" aria-hidden="true" tabindex="-1"></a>(define f (lambda <span class="va">nil</span></span>
<span id="cb119-2"><a href="#cb119-2" aria-hidden="true" tabindex="-1"></a>            (progn </span>
<span id="cb119-3"><a href="#cb119-3" aria-hidden="true" tabindex="-1"></a>                (sleep <span class="dv">1</span>)</span>
<span id="cb119-4"><a href="#cb119-4" aria-hidden="true" tabindex="-1"></a>                (f))))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb120"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb120-1"><a href="#cb120-1" aria-hidden="true" tabindex="-1"></a>(closure <span class="va">nil</span> </span>
<span id="cb120-2"><a href="#cb120-2" aria-hidden="true" tabindex="-1"></a>  (progn </span>
<span id="cb120-3"><a href="#cb120-3" aria-hidden="true" tabindex="-1"></a>      (sleep <span class="dv">1</span>)</span>
<span id="cb120-4"><a href="#cb120-4" aria-hidden="true" tabindex="-1"></a>      (f))</span>
<span id="cb120-5"><a href="#cb120-5" aria-hidden="true" tabindex="-1"></a>  <span class="va">nil</span>)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb121"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb121-1"><a href="#cb121-1" aria-hidden="true" tabindex="-1"></a>(define pid (spawn f))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb122"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb122-1"><a href="#cb122-1" aria-hidden="true" tabindex="-1"></a><span class="dv">14208</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb123"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb123-1"><a href="#cb123-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">send</span> pid <span class="st">&quot;hello world&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb124"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb124-1"><a href="#cb124-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb125"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb125-1"><a href="#cb125-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">send</span> pid (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb126"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb126-1"><a href="#cb126-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb127"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb127-1"><a href="#cb127-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">send</span> pid <span class="at">&#39;apa</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb128"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb128-1"><a href="#cb128-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb129"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb129-1"><a href="#cb129-1" aria-hidden="true" tabindex="-1"></a>(mailbox-get pid)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb130"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb130-1"><a href="#cb130-1" aria-hidden="true" tabindex="-1"></a>(<span class="st">&quot;hello world&quot;</span> (<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>) apa)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="version">Version</h2>
<h3 id="lbm-version">lbm-version</h3>
<p><code>lbm-version</code> returns the version of the lbm runtime
system.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb131"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb131-1"><a href="#cb131-1" aria-hidden="true" tabindex="-1"></a>(lbm-version)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb132"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb132-1"><a href="#cb132-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span> <span class="dv">34</span> <span class="dv">2</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="is-64bit">is-64bit</h3>
<p><code>is-64bit</code> returns true if a 64bit version of lbm is
running.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb133"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb133-1"><a href="#cb133-1" aria-hidden="true" tabindex="-1"></a>(is<span class="dv">-64</span>bit)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb134"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb134-1"><a href="#cb134-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="word-size">word-size</h3>
<p><code>word-size</code> returns 4 on 32bit LBM and 8 on 64bits.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb135"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb135-1"><a href="#cb135-1" aria-hidden="true" tabindex="-1"></a>(word-size)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb136"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb136-1"><a href="#cb136-1" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<p>This document was generated by LispBM version 0.34.2</p>
</div> <!-- Close container -->

<footer style="margin-top: 50px; padding: 20px; background: #f8f9fa; border-top: 1px solid #dee2e6; text-align: center;">
  <p>
    <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê Back to Reference Manual Index</a> |
    <a href="https://www.lispbm.com/" style="color: #007bff; text-decoration: none;">LispBM Home</a>
  </p>

  <p>
    Please contact me with questions, suggestions or feedback at blog
    (dot) joel (dot) svensson (at) gmail (dot) com or join the
    <a href="https://discord.gg/KgD4WcnFjv">Discord server</a>.
  </p>

  <p>&copy; Copyright 2025 Bo Joel Svensson</p>

  <p><small>This page was generated using <a href="https://pandoc.org/">Pandoc</a>.</small></p>
</footer>

</body>
</html>
