<!DOCTYPE html>

<html lang="en-US">

<head>
  <meta charset="UTF-8">
  <meta name="description" content="LispBM Reference Documentation - LispBM library of dynamically loadable functionality">
  <meta name="keywords" content="lispbm, lisp, reference, documentation, embedded lisp, microcontroller, LispBM library of dynamically loadable functionality">
  <meta name="author" content="Bo Joel Svensson">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">

  <!-- SEO Meta Tags -->

  <link rel="canonical" href="https://www.lispbm.com/lispbm-reference-manual/dynref/" />
  <meta name="robots" content="index, follow">

  <!-- Open Graph Meta Tags -->

  <meta property="og:title" content="LispBM library of dynamically loadable functionality">
  <meta property="og:description" content="LispBM Reference Documentation - LispBM library of dynamically loadable functionality">
  <meta property="og:image" content="https://www.lispbm.com/images/lispbm_llama_small.png">
  <meta property="og:url" content="https://www.lispbm.com/lispbm-reference-manual/dynref/">
  <meta property="og:type" content="article">
  <meta property="og:site_name" content="LispBM">

  <!-- Twitter Card Meta Tags -->

  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="LispBM library of dynamically loadable functionality">
  <meta name="twitter:description" content="LispBM Reference Documentation - LispBM library of dynamically loadable functionality">
  <meta name="twitter:image" content="https://www.lispbm.com/images/lispbm_llama_small.png">

  <link rel="apple-touch-icon" sizes="180x180" href="https://www.lispbm.com/ico/apple-touch-icon.png">
  <link rel="icon" type="image/png" sizes="32x32" href="https://www.lispbm.com/ico/favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="https://www.lispbm.com/ico/favicon-16x16.png">
  <link rel="shortcut icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" type="image/vnd.microsoft.icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" type="image/x-icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="icon" href="https://www.lispbm.com/ico/favicon.ico">
  <link rel="manifest" href="https://www.lispbm.com/ico/site.webmanifest">

  <link rel="stylesheet" href="reference.css">

  <title>LispBM library of dynamically loadable functionality</title>
</head>

<body data-pagefind-filter="Platform:Core LispBM" data-pagefind-filter="Document:Dynref">

<div style="max-width: 900px; margin: 0 auto; padding: 20px;">
  <div style="margin-bottom: 20px;">
    <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê Back to Reference Manual Index</a>
  </div>

<!-- Content starts here -->

<h1 id="lispbm-library-of-dynamically-loadable-functionality">LispBM
library of dynamically loadable functionality</h1>
<p>With LispBM comes a small library of dynamically loadable functions
and macros. These functions occupy flash memory (if on an embedded
platform) but only use heap if they are actually used by the
application. Providing dynamically loadable operations is a way to save
space while offering more sweet functionality.</p>
<p>LispBM can be built with varying amount of included dynamic loadable
functionality. It is up to the LispBM integrator to decide what is
included. As an integrator you can also decide to roll your entirely own
set of dynamically loadable operations.</p>
<p>The inclusion of dynamically loadable functionality from this library
is determined when LispBM is compiled using the following flags:</p>
<ul>
<li>LBM_USE_DYN_FUNS : Add a library of functions to the dynamic
loader.</li>
<li>LBM_USE_DYN_MACROS : Add a library of macros to the dynamic
loader.</li>
<li>LBM_USE_DYN_DEFSTRUCT : Add the defstruct mechanism, requires
LBM_USE_DYN_FUNS and LBM_USE_DYN_MACROS.</li>
<li>LBM_USE_DYN_LOOPS : Add loop macros, requires
LBM_USE_DYN_MACROS.</li>
<li>LBM_USE_DYN_ARRAYS : Add functions on arrays. Requires
LBM_USE_DYN_MACROS and LBM_USE_DYN_LOOPS.</li>
</ul>
<p>The flags should be given to the compiler as -Dx for example
-DLBM_USE_DYN_FUNS.</p>
<h2 id="functions">functions</h2>
<hr />
<h3 id="abs">abs</h3>
<p>Compute the absolute value</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb1"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>(abs -<span class="dv">1</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb2"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb3"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>(abs -<span class="fl">1.000000</span>f32)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb4"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.000000</span>f32</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb5"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>(abs <span class="dv">1</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb6"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb7"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a>(abs <span class="fl">1.000000</span>f32)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb8"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a><span class="fl">1.000000</span>f32</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb9"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a>(abs (sin -<span class="fl">3.140000</span>f32))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb10"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb10-1"><a href="#cb10-1" aria-hidden="true" tabindex="-1"></a><span class="fl">0.001593</span>f32</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="filter">filter</h3>
<p>Filter a list from unwanted elements as decided by a predicate</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb11"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb11-1"><a href="#cb11-1" aria-hidden="true" tabindex="-1"></a>(define even (lambda (x)</span>
<span id="cb11-2"><a href="#cb11-2" aria-hidden="true" tabindex="-1"></a>               (<span class="kw">=</span> (<span class="kw">mod</span> x <span class="dv">2</span>) <span class="dv">0</span>)))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb12"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb12-1"><a href="#cb12-1" aria-hidden="true" tabindex="-1"></a>(closure (x) </span>
<span id="cb12-2"><a href="#cb12-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">=</span> (<span class="kw">mod</span> x <span class="dv">2</span>) <span class="dv">0</span>)</span>
<span id="cb12-3"><a href="#cb12-3" aria-hidden="true" tabindex="-1"></a>  <span class="va">nil</span>)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb13"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb13-1"><a href="#cb13-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">filter</span> even (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb14"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb14-1"><a href="#cb14-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">2</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="foldl">foldl</h3>
<p><code>foldl</code> walks through a list, left to right, while
accumulating a result from applying a function to the element at hand
and the result of its previous step. foldl takes an initial value used
as the that is combined with the leftmost value of the list in the first
iteration.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb15"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb15-1"><a href="#cb15-1" aria-hidden="true" tabindex="-1"></a>(foldl <span class="kw">+</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb16"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb16-1"><a href="#cb16-1" aria-hidden="true" tabindex="-1"></a><span class="dv">55</span></span></code></pre></div>
</td>
</tr>
</table>

<p><code>foldl</code> has an advantage over <code>foldr</code> in that
it is implemented in a tail-recursive and constant-storage way.</p>
<p>Funnily enough, <code>foldl</code> using function <code>cons</code>
and initial value <code>nil</code> converts a list to a snoc-list.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb17"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb17-1"><a href="#cb17-1" aria-hidden="true" tabindex="-1"></a>(foldl <span class="kw">cons</span> <span class="va">nil</span> (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb18"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb18-1"><a href="#cb18-1" aria-hidden="true" tabindex="-1"></a>((((((((((<span class="va">nil</span> . <span class="dv">1</span>) . <span class="dv">2</span>) . <span class="dv">3</span>) . <span class="dv">4</span>) . <span class="dv">5</span>) . <span class="dv">6</span>) . <span class="dv">7</span>) . <span class="dv">8</span>) . <span class="dv">9</span>) . <span class="dv">10</span>)</span></code></pre></div>
</td>
</tr>
</table>

<p>Now we are going off on a tangent, but <code>car</code> and
<code>cdr</code> switches roles with each other when operating on a
snoc-list.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb19"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb19-1"><a href="#cb19-1" aria-hidden="true" tabindex="-1"></a>(define my-snoc-list (foldl <span class="kw">cons</span> <span class="va">nil</span> (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span>)))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb20"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb20-1"><a href="#cb20-1" aria-hidden="true" tabindex="-1"></a>((((((((((<span class="va">nil</span> . <span class="dv">1</span>) . <span class="dv">2</span>) . <span class="dv">3</span>) . <span class="dv">4</span>) . <span class="dv">5</span>) . <span class="dv">6</span>) . <span class="dv">7</span>) . <span class="dv">8</span>) . <span class="dv">9</span>) . <span class="dv">10</span>)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb21"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb21-1"><a href="#cb21-1" aria-hidden="true" tabindex="-1"></a>(cdr my-snoc-list)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb22"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb22-1"><a href="#cb22-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb23"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb23-1"><a href="#cb23-1" aria-hidden="true" tabindex="-1"></a>(car my-snoc-list)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb24"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb24-1"><a href="#cb24-1" aria-hidden="true" tabindex="-1"></a>(((((((((<span class="va">nil</span> . <span class="dv">1</span>) . <span class="dv">2</span>) . <span class="dv">3</span>) . <span class="dv">4</span>) . <span class="dv">5</span>) . <span class="dv">6</span>) . <span class="dv">7</span>) . <span class="dv">8</span>) . <span class="dv">9</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="foldr">foldr</h3>
<p><code>foldr</code> walks through a list, right to left, while
combining value and prev result step by step. An initial value is
provided and here used in the first, rightmost, operation.</p>
<p><code>foldr</code> has a disadvantage compared to <code>foldl</code>
as I don't think it is possible to give <code>foldr</code> a
constant-space and tail-recursive implementation. One can make
<code>foldr</code> tail-recursive by writing it in continuation passing
style (CPS). The CPS version of foldr will run without building upon the
return stack, but instead it will construct and expand upon a
continuation object each iteration. This continuation object will grow
at the same rate as the call-stack otherwise would but it would grow in
heap usage.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb25"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb25-1"><a href="#cb25-1" aria-hidden="true" tabindex="-1"></a>(foldr <span class="kw">+</span> <span class="dv">0</span> (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb26"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb26-1"><a href="#cb26-1" aria-hidden="true" tabindex="-1"></a><span class="dv">55</span></span></code></pre></div>
</td>
</tr>
</table>

<p>Much less amusingly compared to <code>foldl</code>,
<code>foldr</code> of <code>cons</code> with initial value
<code>nil</code> is the identity function on proper lists.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb27"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb27-1"><a href="#cb27-1" aria-hidden="true" tabindex="-1"></a>(foldr <span class="kw">cons</span> <span class="va">nil</span> (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb28"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb28-1"><a href="#cb28-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span> <span class="dv">5</span> <span class="dv">6</span> <span class="dv">7</span> <span class="dv">8</span> <span class="dv">9</span> <span class="dv">10</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="iota">iota</h3>
<p><code>iota</code> takes one number as argument and generates a list
of values up to (not including) the given number.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb29"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb29-1"><a href="#cb29-1" aria-hidden="true" tabindex="-1"></a>(iota <span class="dv">4</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb30"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb30-1"><a href="#cb30-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">0</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="second">second</h3>
<p><code>second</code> extracts the second element from a list.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb31"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb31-1"><a href="#cb31-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">second</span> (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb32"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb32-1"><a href="#cb32-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb33"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb33-1"><a href="#cb33-1" aria-hidden="true" tabindex="-1"></a>(<span class="kw">second</span> (<span class="kw">list</span> <span class="dv">1</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb34"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb34-1"><a href="#cb34-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="str-cmp-asc">str-cmp-asc</h3>
<p>compare strings according to alphabetical order ascending.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb35"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb35-1"><a href="#cb35-1" aria-hidden="true" tabindex="-1"></a>(str-cmp-asc <span class="st">&quot;apa&quot;</span> <span class="st">&quot;bepa&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb36"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb36-1"><a href="#cb36-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb37"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb37-1"><a href="#cb37-1" aria-hidden="true" tabindex="-1"></a>(str-cmp-asc <span class="st">&quot;bepa&quot;</span> <span class="st">&quot;apa&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb38"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb38-1"><a href="#cb38-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="str-cmp-dsc">str-cmp-dsc</h3>
<p>compare strings according to alphabetical order descending.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb39"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb39-1"><a href="#cb39-1" aria-hidden="true" tabindex="-1"></a>(str-cmp-dsc <span class="st">&quot;apa&quot;</span> <span class="st">&quot;bepa&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb40"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb40-1"><a href="#cb40-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb41"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb41-1"><a href="#cb41-1" aria-hidden="true" tabindex="-1"></a>(str-cmp-dsc <span class="st">&quot;bepa&quot;</span> <span class="st">&quot;apa&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb42"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb42-1"><a href="#cb42-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="str-merge">str-merge</h3>
<p><code>str-merge</code> is an alternative name for the
<code>str-join</code> operations. It is kept around for backwards
compatibility.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb43"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb43-1"><a href="#cb43-1" aria-hidden="true" tabindex="-1"></a>(str-merge <span class="st">&quot;Kurt&quot;</span> <span class="st">&quot; &quot;</span> <span class="st">&quot;Russel&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb44"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb44-1"><a href="#cb44-1" aria-hidden="true" tabindex="-1"></a><span class="st">&quot;Kurt Russel&quot;</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="third">third</h3>
<p><code>third</code> extracts the third element from a list.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb45"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb45-1"><a href="#cb45-1" aria-hidden="true" tabindex="-1"></a>(third (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb46"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb46-1"><a href="#cb46-1" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb47"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb47-1"><a href="#cb47-1" aria-hidden="true" tabindex="-1"></a>(third (<span class="kw">list</span> <span class="dv">1</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb48"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb48-1"><a href="#cb48-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="macros">macros</h2>
<hr />
<h3 id="defun">defun</h3>
<p><code>defun</code> is a macro that provides a shorthand form for
defining a named function. <code>(defun name args body)</code> is
expanded into <code>(define name (lambda args body))</code>.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb49"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb49-1"><a href="#cb49-1" aria-hidden="true" tabindex="-1"></a>(defun f (x)</span>
<span id="cb49-2"><a href="#cb49-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">+</span> x <span class="dv">1</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb50"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb50-1"><a href="#cb50-1" aria-hidden="true" tabindex="-1"></a>(closure (x) </span>
<span id="cb50-2"><a href="#cb50-2" aria-hidden="true" tabindex="-1"></a>  (<span class="kw">+</span> x <span class="dv">1</span>)</span>
<span id="cb50-3"><a href="#cb50-3" aria-hidden="true" tabindex="-1"></a>  <span class="va">nil</span>)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb51"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb51-1"><a href="#cb51-1" aria-hidden="true" tabindex="-1"></a>(f <span class="dv">1</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb52"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb52-1"><a href="#cb52-1" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="defunret">defunret</h3>
<p><code>defunret</code> is like <code>defun</code> but you are allowed
to <code>return</code> at any point in the function body.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb53"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb53-1"><a href="#cb53-1" aria-hidden="true" tabindex="-1"></a>(defunret g (x) (progn </span>
<span id="cb53-2"><a href="#cb53-2" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">1</span></span>
<span id="cb53-3"><a href="#cb53-3" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">2</span></span>
<span id="cb53-4"><a href="#cb53-4" aria-hidden="true" tabindex="-1"></a>                    (return <span class="dv">55</span>)</span>
<span id="cb53-5"><a href="#cb53-5" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">3</span></span>
<span id="cb53-6"><a href="#cb53-6" aria-hidden="true" tabindex="-1"></a>                    <span class="dv">4</span></span>
<span id="cb53-7"><a href="#cb53-7" aria-hidden="true" tabindex="-1"></a>                    x))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb54"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb54-1"><a href="#cb54-1" aria-hidden="true" tabindex="-1"></a>(closure (x) </span>
<span id="cb54-2"><a href="#cb54-2" aria-hidden="true" tabindex="-1"></a>  (call-cc-unsafe (lambda (return)</span>
<span id="cb54-3"><a href="#cb54-3" aria-hidden="true" tabindex="-1"></a>                    (progn </span>
<span id="cb54-4"><a href="#cb54-4" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">1</span></span>
<span id="cb54-5"><a href="#cb54-5" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">2</span></span>
<span id="cb54-6"><a href="#cb54-6" aria-hidden="true" tabindex="-1"></a>                        (return <span class="dv">55</span>)</span>
<span id="cb54-7"><a href="#cb54-7" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">3</span></span>
<span id="cb54-8"><a href="#cb54-8" aria-hidden="true" tabindex="-1"></a>                        <span class="dv">4</span></span>
<span id="cb54-9"><a href="#cb54-9" aria-hidden="true" tabindex="-1"></a>                        x)))</span>
<span id="cb54-10"><a href="#cb54-10" aria-hidden="true" tabindex="-1"></a>  <span class="va">nil</span>)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb55"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb55-1"><a href="#cb55-1" aria-hidden="true" tabindex="-1"></a>(g <span class="dv">10</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb56"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb56-1"><a href="#cb56-1" aria-hidden="true" tabindex="-1"></a><span class="dv">55</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="defmacro">defmacro</h3>
<p><code>defmacro</code> is a macro that provides a shorthand form for
defining macros. <code>(defmacro name args body)</code> expands into
<code>(define name (macro args body))</code>.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb57"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb57-1"><a href="#cb57-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defmacro</span><span class="fu"> my-macro </span>(a) `(<span class="kw">list</span> <span class="at">&#39;apa</span> ,a))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb58"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb58-1"><a href="#cb58-1" aria-hidden="true" tabindex="-1"></a>(macro (a) (append &#39;(<span class="kw">list</span>) (<span class="kw">list</span> <span class="at">&#39;&#39;apa</span>) (<span class="kw">list</span> a)))</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb59"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb59-1"><a href="#cb59-1" aria-hidden="true" tabindex="-1"></a>(my-macro <span class="dv">10</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb60"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb60-1"><a href="#cb60-1" aria-hidden="true" tabindex="-1"></a>(apa <span class="dv">10</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="loop-macros">loop macros</h2>
<hr />
<h3 id="loopfor">loopfor</h3>
<p><code>loopfor</code> has the form
<code>(loopfor it start cond update body)</code> and implements a for
loop as familiar from for example C.</p>
<p><code>it</code> is the iterator, <code>start</code> is what it is
initialized to, <code>cond</code> is the condition that has the be true
for the loop to continue running, <code>update</code> is how to update
the iterator after each iteration and body is the code to execute each
iteration. The iterator can be accessed from within body.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb61"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb61-1"><a href="#cb61-1" aria-hidden="true" tabindex="-1"></a>(define r <span class="dv">0</span>)</span>
<span id="cb61-2"><a href="#cb61-2" aria-hidden="true" tabindex="-1"></a>(loopfor i <span class="dv">0</span> (<span class="kw">&lt;</span> i <span class="dv">5</span>) (<span class="kw">+</span> i <span class="dv">1</span>)</span>
<span id="cb61-3"><a href="#cb61-3" aria-hidden="true" tabindex="-1"></a>         (setq r (<span class="kw">+</span> r i)))</span>
<span id="cb61-4"><a href="#cb61-4" aria-hidden="true" tabindex="-1"></a>r</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb62"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb62-1"><a href="#cb62-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="loopwhile">loopwhile</h3>
<p><code>loopwhile</code> has the form
<code>(loopwhile cond body)</code> and implements a while loop as
familiar from for example C.</p>
<p><code>cond</code> is the condition that has the be true for the loop
to continue running and <code>body</code> is the code to execute each
iteration.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb63"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb63-1"><a href="#cb63-1" aria-hidden="true" tabindex="-1"></a>(define a <span class="dv">0</span>)</span>
<span id="cb63-2"><a href="#cb63-2" aria-hidden="true" tabindex="-1"></a>(loopwhile (<span class="kw">&lt;</span> a <span class="dv">10</span>)</span>
<span id="cb63-3"><a href="#cb63-3" aria-hidden="true" tabindex="-1"></a>           (setq a (<span class="kw">+</span> a <span class="dv">1</span>)))</span>
<span id="cb63-4"><a href="#cb63-4" aria-hidden="true" tabindex="-1"></a>a</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb64"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb64-1"><a href="#cb64-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="looprange">looprange</h3>
<p><code>looprange</code> has the form
<code>(looprange it start end body)</code> and implements a loop over a
range similar to python's <code>for i in range(n)</code>.</p>
<p>Iterate <code>it</code> from <code>start</code> to <code>end</code>
and evaluate <code>body</code> for each iteration. The iterator it can
be accessed from within body.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb65"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb65-1"><a href="#cb65-1" aria-hidden="true" tabindex="-1"></a>(define b <span class="dv">0</span>)</span>
<span id="cb65-2"><a href="#cb65-2" aria-hidden="true" tabindex="-1"></a>(looprange i <span class="dv">0</span> <span class="dv">11</span> (setq b (<span class="kw">+</span> b i)))</span>
<span id="cb65-3"><a href="#cb65-3" aria-hidden="true" tabindex="-1"></a>b</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb66"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb66-1"><a href="#cb66-1" aria-hidden="true" tabindex="-1"></a><span class="dv">55</span></span></code></pre></div>
</td>
</tr>
</table>

<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb67"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb67-1"><a href="#cb67-1" aria-hidden="true" tabindex="-1"></a>(define my-ls <span class="va">nil</span>)</span>
<span id="cb67-2"><a href="#cb67-2" aria-hidden="true" tabindex="-1"></a>(looprange i <span class="dv">0</span> <span class="dv">5</span> (setq my-ls (<span class="kw">cons</span> i my-ls)))</span>
<span id="cb67-3"><a href="#cb67-3" aria-hidden="true" tabindex="-1"></a>my-ls</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb68"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb68-1"><a href="#cb68-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">4</span> <span class="dv">3</span> <span class="dv">2</span> <span class="dv">1</span> <span class="dv">0</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="loopforeach">loopforeach</h3>
<p><code>loopforeach</code> has the form
<code>(loopforeach it lst body)</code> and implements a loop over the
elements of a list similar to python's <code>for e in ...</code>.</p>
<p>Iterate over every element in the list <code>lst</code> and evaluate
<code>body</code> for each iteration. The iterator <code>it</code> can
be accessed from within body.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb69"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb69-1"><a href="#cb69-1" aria-hidden="true" tabindex="-1"></a>(define m <span class="dv">0</span>)</span>
<span id="cb69-2"><a href="#cb69-2" aria-hidden="true" tabindex="-1"></a>(loopforeach <span class="kw">e</span> (<span class="kw">list</span> <span class="dv">2</span> <span class="dv">4</span> <span class="dv">6</span> <span class="dv">8</span>) (setq m (<span class="kw">+</span> m <span class="kw">e</span>)))</span>
<span id="cb69-3"><a href="#cb69-3" aria-hidden="true" tabindex="-1"></a>m</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb70"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb70-1"><a href="#cb70-1" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="loopwhile-thd">loopwhile-thd</h3>
<p><code>loopwhile-thd</code> is like <code>loopwhile</code> but the
thread runs in its own thread asynchronously. The form of a
<code>loopwhile-thd</code> is
<code>(loopwhile-thd stack cond body)</code>.</p>
<p>A While-loop that starts in a new thread. The argument
<code>stack</code> is the stack-size of the thread, <code>cond</code> is
the condition that has the be true for the loop to continue running and
<code>body</code> is the code to execute each iteration. The difference
from the regular loopwhile is that the evaluator will continue running
the code after this one before this one finishes, as this loop is
evaluated in a new thread.</p>
<p>The following examples assumes that your LispBM integration has a way
to <code>print</code>.</p>
<p>Example that forever prints "Hello World" every two seconds:</p>
<pre><code> (loopwhile-thd 100 t { 
    (print &quot;Hello World&quot;) 
    (sleep 2) 
 })</code></pre>
<p>The above is equivalent to the following code</p>
<pre><code>(spawn 100 (fn () (loopwhile t {
                 (print &quot;Hello World&quot;)
                 (sleep 2)
})))</code></pre>
<p>It is possible to give the thread a name and/or a stack size. That
gives the following combinations of possibilities:</p>
<p>No name and default stack size</p>
<pre><code>(loopwhile-thd () t {
        (print &quot;Hello World1&quot;)
        (sleep 2)
})</code></pre>
<p>No name and stack size 100</p>
<pre><code>(loopwhile-thd 100 t {
        (print &quot;Hello World2&quot;)
        (sleep 2)
})</code></pre>
<p>Name ThdTest and default stack size</p>
<pre><code>(loopwhile-thd &quot;ThdTest&quot; t {
        (print &quot;Hello World3&quot;
)         (sleep 2)
})</code></pre>
<p>Name ThdTest2 and stack size 100</p>
<pre><code>(loopwhile-thd (&quot;ThdTest2&quot; 100) t {
        (print &quot;Hello World4&quot;)
        (sleep 2)
})</code></pre>
<hr />
<h2 id="array-functions">Array functions</h2>
<hr />
<h3 id="list-to-array">list-to-array</h3>
<p>Convert a list to an array</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb77"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb77-1"><a href="#cb77-1" aria-hidden="true" tabindex="-1"></a>(list-to-array (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb78"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb78-1"><a href="#cb78-1" aria-hidden="true" tabindex="-1"></a>[|<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>|]</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb79"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb79-1"><a href="#cb79-1" aria-hidden="true" tabindex="-1"></a>(list-to-array &#39;(<span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb80"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb80-1"><a href="#cb80-1" aria-hidden="true" tabindex="-1"></a>[|<span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span>|]</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="array-to-list">array-to-list</h3>
<p>Convert an array to a list</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb81"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb81-1"><a href="#cb81-1" aria-hidden="true" tabindex="-1"></a>(array-to-list (list-to-array (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb82"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb82-1"><a href="#cb82-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>)</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb83"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb83-1"><a href="#cb83-1" aria-hidden="true" tabindex="-1"></a>(array-to-list [|<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>|])</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb84"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb84-1"><a href="#cb84-1" aria-hidden="true" tabindex="-1"></a>(<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span> <span class="dv">4</span>)</span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h3 id="array">array?</h3>
<p>Array predicate is true for arrays.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb85"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb85-1"><a href="#cb85-1" aria-hidden="true" tabindex="-1"></a>(array? [|<span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>|])</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb86"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb86-1"><a href="#cb86-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb87"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb87-1"><a href="#cb87-1" aria-hidden="true" tabindex="-1"></a>(array? <span class="dv">1</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb88"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb88-1"><a href="#cb88-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb89"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb89-1"><a href="#cb89-1" aria-hidden="true" tabindex="-1"></a>(array? <span class="at">&#39;apa</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb90"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb90-1"><a href="#cb90-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb91"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb91-1"><a href="#cb91-1" aria-hidden="true" tabindex="-1"></a>(array? (<span class="kw">list</span> <span class="dv">1</span> <span class="dv">2</span> <span class="dv">3</span>))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb92"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb92-1"><a href="#cb92-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<hr />
<h2 id="defstruct-and-its-operations">defstruct and its operations</h2>
<hr />
<p><code>defstruct</code> defines a datastructure with named fields
similar to a <code>struct</code> in C. <code>defstruct</code> takes two
arguments, a struct name and a list of fields
<code>(defstruct name list-of-fields)</code>.</p>
<p>Structs are implemented as arrays of lisp values and offer constant
time lookup of each of its fields. The struct itself does not occupy
heap cells, but the values stored in the fields may.</p>
<p>As structs are allocated from array memory (lbm_memory), there is a
potential for causing memory fragmentation.</p>
<p>The example below creates a structure type called my-struct with
three fields called <code>a</code>, <code>b</code> and
<code>c</code>.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb93"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb93-1"><a href="#cb93-1" aria-hidden="true" tabindex="-1"></a>(<span class="bu">defstruct</span><span class="fu"> my-struct </span>(a b c))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb94"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb94-1"><a href="#cb94-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
</table>

<p>Now instances of <code>my-struct</code> can be created using
<code>make-my-struct</code>.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb95"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb95-1"><a href="#cb95-1" aria-hidden="true" tabindex="-1"></a>(define s1 (make-my-struct))</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb96"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb96-1"><a href="#cb96-1" aria-hidden="true" tabindex="-1"></a>[|my-struct <span class="va">nil</span> <span class="va">nil</span> <span class="va">nil</span>|]</span></code></pre></div>
</td>
</tr>
</table>

<p>when a struct is defined using <code>defstruct</code> a number of
functions for manipulation of that kind of struct is automatically
generated.</p>
<ul>
<li>make-name : function for creation of struct with name
<code>name</code>.</li>
<li>name? : predicate that is true for instances of the struct named
<code>name</code>.</li>
<li>name-x : setter/getter for struct <code>name</code> and field
<code>x</code>.</li>
</ul>
<p>This will be more clear by showing with <code>my-struct</code> as
example.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb97"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb97-1"><a href="#cb97-1" aria-hidden="true" tabindex="-1"></a>(my-struct? s1)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb98"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb98-1"><a href="#cb98-1" aria-hidden="true" tabindex="-1"></a>t</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb99"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb99-1"><a href="#cb99-1" aria-hidden="true" tabindex="-1"></a>(my-struct? <span class="st">&quot;hej&quot;</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb100"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb100-1"><a href="#cb100-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb101"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb101-1"><a href="#cb101-1" aria-hidden="true" tabindex="-1"></a>(my-struct? <span class="dv">10</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb102"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb102-1"><a href="#cb102-1" aria-hidden="true" tabindex="-1"></a><span class="va">nil</span></span></code></pre></div>
</td>
</tr>
</table>

<p><code>my-struct?</code> is a predicate that is true for instances of
<code>my.struct</code>.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb103"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb103-1"><a href="#cb103-1" aria-hidden="true" tabindex="-1"></a>(my-struct-a s1 <span class="dv">10</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb104"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb104-1"><a href="#cb104-1" aria-hidden="true" tabindex="-1"></a>[|my-struct <span class="dv">10</span> <span class="va">nil</span> <span class="va">nil</span>|]</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb105"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb105-1"><a href="#cb105-1" aria-hidden="true" tabindex="-1"></a>(my-struct-b s1 <span class="dv">20</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb106"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb106-1"><a href="#cb106-1" aria-hidden="true" tabindex="-1"></a>[|my-struct <span class="dv">10</span> <span class="dv">20</span> <span class="va">nil</span>|]</span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb107"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb107-1"><a href="#cb107-1" aria-hidden="true" tabindex="-1"></a>(my-struct-c s1 <span class="dv">30</span>)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb108"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb108-1"><a href="#cb108-1" aria-hidden="true" tabindex="-1"></a>[|my-struct <span class="dv">10</span> <span class="dv">20</span> <span class="dv">30</span>|]</span></code></pre></div>
</td>
</tr>
</table>

<p><code>my-struct-x</code> with 2 arguments is a setter. with just the
struct instance as argument it is a getter.</p>
<table>
<tr>
<td> Example </td> <td> Result </td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb109"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb109-1"><a href="#cb109-1" aria-hidden="true" tabindex="-1"></a>(my-struct-a s1)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb110"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb110-1"><a href="#cb110-1" aria-hidden="true" tabindex="-1"></a><span class="dv">10</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb111"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb111-1"><a href="#cb111-1" aria-hidden="true" tabindex="-1"></a>(my-struct-b s1)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb112"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb112-1"><a href="#cb112-1" aria-hidden="true" tabindex="-1"></a><span class="dv">20</span></span></code></pre></div>
</td>
</tr>
<tr>
<td>

<div class="sourceCode" id="cb113"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb113-1"><a href="#cb113-1" aria-hidden="true" tabindex="-1"></a>(my-struct-c s1)</span></code></pre></div>
</td>
<td>

<div class="sourceCode" id="cb114"><pre
class="sourceCode clj"><code class="sourceCode clojure"><span id="cb114-1"><a href="#cb114-1" aria-hidden="true" tabindex="-1"></a><span class="dv">30</span></span></code></pre></div>
</td>
</tr>
</table>

<p>This document was generated by LispBM version 0.34.2</p>
</div> <!-- Close container -->

<footer style="margin-top: 50px; padding: 20px; background: #f8f9fa; border-top: 1px solid #dee2e6; text-align: center;">
  <p>
    <a href="index.html" style="color: #007bff; text-decoration: none;">‚Üê Back to Reference Manual Index</a> |
    <a href="https://www.lispbm.com/" style="color: #007bff; text-decoration: none;">LispBM Home</a>
  </p>

  <p>
    Please contact me with questions, suggestions or feedback at blog
    (dot) joel (dot) svensson (at) gmail (dot) com or join the
    <a href="https://discord.gg/KgD4WcnFjv">Discord server</a>.
  </p>

  <p>&copy; Copyright 2025 Bo Joel Svensson</p>

  <p><small>This page was generated using <a href="https://pandoc.org/">Pandoc</a>.</small></p>
</footer>

</body>
</html>
